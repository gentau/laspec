

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>laspec package &mdash; laspec 2021.123.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Tutorials" href="tutorial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> laspec
          

          
          </a>

          
            
            
              <div class="version">
                2021.123.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">laspec</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#authors">Authors</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">laspec package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.bh">laspec.bh module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.binning">laspec.binning module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.ccf">laspec.ccf module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.convolution">laspec.convolution module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.core">laspec.core module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.fof">laspec.fof module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.helper">laspec.helper module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.interpolate">laspec.interpolate module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.lamost">laspec.lamost module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.light_curve">laspec.light_curve module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.line_index">laspec.line_index module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.mpl">laspec.mpl module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.mrs">laspec.mrs module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#laspec-neural-network-module">laspec.neural_network module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.nn">laspec.nn module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.normalization">laspec.normalization module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.optimize">laspec.optimize module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.qconv">laspec.qconv module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.read_spectrum">laspec.read_spectrum module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.rvc">laspec.rvc module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.slam_model">laspec.slam_model module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.snstat">laspec.snstat module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.spec">laspec.spec module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.stilts">laspec.stilts module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec.wavelength">laspec.wavelength module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-laspec">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">laspec</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>laspec package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/laspec.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="laspec-package">
<h1>laspec package<a class="headerlink" href="#laspec-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-laspec.bh">
<span id="laspec-bh-module"></span><h2>laspec.bh module<a class="headerlink" href="#module-laspec.bh" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="laspec.bh.calculate_m2">
<code class="sig-prename descclassname">laspec.bh.</code><code class="sig-name descname">calculate_m2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Pday</span><span class="o">=</span><span class="default_value">14.5</span></em>, <em class="sig-param"><span class="n">ideg</span><span class="o">=</span><span class="default_value">90</span></em>, <em class="sig-param"><span class="n">m1</span><span class="o">=</span><span class="default_value">2.16</span></em>, <em class="sig-param"><span class="n">Kkms</span><span class="o">=</span><span class="default_value">50</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/bh.html#calculate_m2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.bh.calculate_m2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the mass of the secondary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Pday</strong> (<em>float</em>) – Period in days</p></li>
<li><p><strong>ideg</strong> – inclination in degrees</p></li>
<li><p><strong>m1</strong> – the mass of the primary in Msun</p></li>
<li><p><strong>Kkms</strong> – the K of the primary in km/s</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the mass of the secondary</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>M2</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-laspec.binning">
<span id="laspec-binning-module"></span><h2>laspec.binning module<a class="headerlink" href="#module-laspec.binning" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="laspec.binning.center2edge">
<code class="sig-prename descclassname">laspec.binning.</code><code class="sig-name descname">center2edge</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/binning.html#center2edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.binning.center2edge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.binning.rebin">
<code class="sig-prename descclassname">laspec.binning.</code><code class="sig-name descname">rebin</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">flux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flux_err</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wave_new</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/binning.html#rebin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.binning.rebin" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebin spectrum to a new wavelength grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<em>array</em>) – old wavelength</p></li>
<li><p><strong>flux</strong> (<em>array</em>) – old flux</p></li>
<li><p><strong>flux_err</strong> (<em>array</em><em> (</em><em>optional</em><em>)</em>) – old flux error</p></li>
<li><p><strong>mask</strong> (<em>array</em><em> (</em><em>optional</em><em>)</em>) – old mask, True for bad.</p></li>
<li><p><strong>wave_new</strong> – new wavelength. if None, use log10 wavelength.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>re-binned (flux, [flux_err], [mask])</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-laspec.ccf">
<span id="laspec-ccf-module"></span><h2>laspec.ccf module<a class="headerlink" href="#module-laspec.ccf" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="laspec.ccf.RVM">
<em class="property">class </em><code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">RVM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pmod</span></em>, <em class="sig-param"><span class="n">wave_mod</span></em>, <em class="sig-param"><span class="n">flux_mod</span></em>, <em class="sig-param"><span class="n">npix_lv</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#RVM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.RVM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="laspec.ccf.RVM.ccf_1mod">
<code class="sig-name descname">ccf_1mod</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave_mod</span></em>, <em class="sig-param"><span class="n">flux_mod</span></em>, <em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">w_mod</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w_obs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sinebell_idx</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">rv_grid</span><span class="o">=</span><span class="default_value">array([- 600., - 587.87878788, - 575.75757576, - 563.63636364, - 551.51515152, - 539.39393939, - 527.27272727, - 515.15151515, - 503.03030303, - 490.90909091, - 478.78787879, - 466.66666667, - 454.54545455, - 442.42424242, - 430.3030303, - 418.18181818, - 406.06060606, - 393.93939394, - 381.81818182, - 369.6969697, - 357.57575758, - 345.45454545, - 333.33333333, - 321.21212121, - 309.09090909, - 296.96969697, - 284.84848485, - 272.72727273, - 260.60606061, - 248.48484848, - 236.36363636, - 224.24242424, - 212.12121212, - 200., - 187.87878788, - 175.75757576, - 163.63636364, - 151.51515152, - 139.39393939, - 127.27272727, - 115.15151515, - 103.03030303, - 90.90909091, - 78.78787879, - 66.66666667, - 54.54545455, - 42.42424242, - 30.3030303, - 18.18181818, - 6.06060606, 6.06060606, 18.18181818, 30.3030303, 42.42424242, 54.54545455, 66.66666667, 78.78787879, 90.90909091, 103.03030303, 115.15151515, 127.27272727, 139.39393939, 151.51515152, 163.63636364, 175.75757576, 187.87878788, 200., 212.12121212, 224.24242424, 236.36363636, 248.48484848, 260.60606061, 272.72727273, 284.84848485, 296.96969697, 309.09090909, 321.21212121, 333.33333333, 345.45454545, 357.57575758, 369.6969697, 381.81818182, 393.93939394, 406.06060606, 418.18181818, 430.3030303, 442.42424242, 454.54545455, 466.66666667, 478.78787879, 490.90909091, 503.03030303, 515.15151515, 527.27272727, 539.39393939, 551.51515152, 563.63636364, 575.75757576, 587.87878788, 600.])</span></em>, <em class="sig-param"><span class="n">flux_bounds</span><span class="o">=</span><span class="default_value">(0, 3.0)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#RVM.ccf_1mod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.RVM.ccf_1mod" title="Permalink to this definition">¶</a></dt>
<dd><p>measure RV</p>
</dd></dl>

<dl class="py method">
<dt id="laspec.ccf.RVM.chi2_1mod">
<code class="sig-name descname">chi2_1mod</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imod</span></em>, <em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">rv_grid</span><span class="o">=</span><span class="default_value">array([- 600., - 587.87878788, - 575.75757576, - 563.63636364, - 551.51515152, - 539.39393939, - 527.27272727, - 515.15151515, - 503.03030303, - 490.90909091, - 478.78787879, - 466.66666667, - 454.54545455, - 442.42424242, - 430.3030303, - 418.18181818, - 406.06060606, - 393.93939394, - 381.81818182, - 369.6969697, - 357.57575758, - 345.45454545, - 333.33333333, - 321.21212121, - 309.09090909, - 296.96969697, - 284.84848485, - 272.72727273, - 260.60606061, - 248.48484848, - 236.36363636, - 224.24242424, - 212.12121212, - 200., - 187.87878788, - 175.75757576, - 163.63636364, - 151.51515152, - 139.39393939, - 127.27272727, - 115.15151515, - 103.03030303, - 90.90909091, - 78.78787879, - 66.66666667, - 54.54545455, - 42.42424242, - 30.3030303, - 18.18181818, - 6.06060606, 6.06060606, 18.18181818, 30.3030303, 42.42424242, 54.54545455, 66.66666667, 78.78787879, 90.90909091, 103.03030303, 115.15151515, 127.27272727, 139.39393939, 151.51515152, 163.63636364, 175.75757576, 187.87878788, 200., 212.12121212, 224.24242424, 236.36363636, 248.48484848, 260.60606061, 272.72727273, 284.84848485, 296.96969697, 309.09090909, 321.21212121, 333.33333333, 345.45454545, 357.57575758, 369.6969697, 381.81818182, 393.93939394, 406.06060606, 418.18181818, 430.3030303, 442.42424242, 454.54545455, 466.66666667, 478.78787879, 490.90909091, 503.03030303, 515.15151515, 527.27272727, 539.39393939, 551.51515152, 563.63636364, 575.75757576, 587.87878788, 600.])</span></em>, <em class="sig-param"><span class="n">pw</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">flux_bounds</span><span class="o">=</span><span class="default_value">(0, 3.0)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#RVM.chi2_1mod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.RVM.chi2_1mod" title="Permalink to this definition">¶</a></dt>
<dd><p>measure RV</p>
</dd></dl>

<dl class="py method">
<dt id="laspec.ccf.RVM.measure">
<code class="sig-name descname">measure</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">flux_err</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w_mod</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w_obs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sinebell_idx</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">rv_grid</span><span class="o">=</span><span class="default_value">array([- 600., - 587.87878788, - 575.75757576, - 563.63636364, - 551.51515152, - 539.39393939, - 527.27272727, - 515.15151515, - 503.03030303, - 490.90909091, - 478.78787879, - 466.66666667, - 454.54545455, - 442.42424242, - 430.3030303, - 418.18181818, - 406.06060606, - 393.93939394, - 381.81818182, - 369.6969697, - 357.57575758, - 345.45454545, - 333.33333333, - 321.21212121, - 309.09090909, - 296.96969697, - 284.84848485, - 272.72727273, - 260.60606061, - 248.48484848, - 236.36363636, - 224.24242424, - 212.12121212, - 200., - 187.87878788, - 175.75757576, - 163.63636364, - 151.51515152, - 139.39393939, - 127.27272727, - 115.15151515, - 103.03030303, - 90.90909091, - 78.78787879, - 66.66666667, - 54.54545455, - 42.42424242, - 30.3030303, - 18.18181818, - 6.06060606, 6.06060606, 18.18181818, 30.3030303, 42.42424242, 54.54545455, 66.66666667, 78.78787879, 90.90909091, 103.03030303, 115.15151515, 127.27272727, 139.39393939, 151.51515152, 163.63636364, 175.75757576, 187.87878788, 200., 212.12121212, 224.24242424, 236.36363636, 248.48484848, 260.60606061, 272.72727273, 284.84848485, 296.96969697, 309.09090909, 321.21212121, 333.33333333, 345.45454545, 357.57575758, 369.6969697, 381.81818182, 393.93939394, 406.06060606, 418.18181818, 430.3030303, 442.42424242, 454.54545455, 466.66666667, 478.78787879, 490.90909091, 503.03030303, 515.15151515, 527.27272727, 539.39393939, 551.51515152, 563.63636364, 575.75757576, 587.87878788, 600.])</span></em>, <em class="sig-param"><span class="n">flux_bounds</span><span class="o">=</span><span class="default_value">(0, 3.0)</span></em>, <em class="sig-param"><span class="n">nmc</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'BFGS'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#RVM.measure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.RVM.measure" title="Permalink to this definition">¶</a></dt>
<dd><p>measure RV</p>
</dd></dl>

<dl class="py method">
<dt id="laspec.ccf.RVM.measure2">
<code class="sig-name descname">measure2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">flux_err</span></em>, <em class="sig-param"><span class="n">wave_mod1</span></em>, <em class="sig-param"><span class="n">flux_mod1</span></em>, <em class="sig-param"><span class="n">wave_mod2</span></em>, <em class="sig-param"><span class="n">flux_mod2</span></em>, <em class="sig-param"><span class="n">w_obs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rv1_init</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">eta_init</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">eta_lim</span><span class="o">=</span><span class="default_value">(0.1, 1.0)</span></em>, <em class="sig-param"><span class="n">drvmax</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">drvstep</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'Powell'</span></em>, <em class="sig-param"><span class="n">nmc</span><span class="o">=</span><span class="default_value">100</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#RVM.measure2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.RVM.measure2" title="Permalink to this definition">¶</a></dt>
<dd><p>given a template, optimize (rv1, drv, eta)</p>
</dd></dl>

<dl class="py method">
<dt id="laspec.ccf.RVM.measure_binary">
<code class="sig-name descname">measure_binary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">flux_err</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w_obs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rv_grid</span><span class="o">=</span><span class="default_value">array([- 600., - 587.87878788, - 575.75757576, - 563.63636364, - 551.51515152, - 539.39393939, - 527.27272727, - 515.15151515, - 503.03030303, - 490.90909091, - 478.78787879, - 466.66666667, - 454.54545455, - 442.42424242, - 430.3030303, - 418.18181818, - 406.06060606, - 393.93939394, - 381.81818182, - 369.6969697, - 357.57575758, - 345.45454545, - 333.33333333, - 321.21212121, - 309.09090909, - 296.96969697, - 284.84848485, - 272.72727273, - 260.60606061, - 248.48484848, - 236.36363636, - 224.24242424, - 212.12121212, - 200., - 187.87878788, - 175.75757576, - 163.63636364, - 151.51515152, - 139.39393939, - 127.27272727, - 115.15151515, - 103.03030303, - 90.90909091, - 78.78787879, - 66.66666667, - 54.54545455, - 42.42424242, - 30.3030303, - 18.18181818, - 6.06060606, 6.06060606, 18.18181818, 30.3030303, 42.42424242, 54.54545455, 66.66666667, 78.78787879, 90.90909091, 103.03030303, 115.15151515, 127.27272727, 139.39393939, 151.51515152, 163.63636364, 175.75757576, 187.87878788, 200., 212.12121212, 224.24242424, 236.36363636, 248.48484848, 260.60606061, 272.72727273, 284.84848485, 296.96969697, 309.09090909, 321.21212121, 333.33333333, 345.45454545, 357.57575758, 369.6969697, 381.81818182, 393.93939394, 406.06060606, 418.18181818, 430.3030303, 442.42424242, 454.54545455, 466.66666667, 478.78787879, 490.90909091, 503.03030303, 515.15151515, 527.27272727, 539.39393939, 551.51515152, 563.63636364, 575.75757576, 587.87878788, 600.])</span></em>, <em class="sig-param"><span class="n">flux_bounds</span><span class="o">=</span><span class="default_value">(0, 3.0)</span></em>, <em class="sig-param"><span class="n">twin</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">eta_init</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">eta_lim</span><span class="o">=</span><span class="default_value">(0.01, 3.0)</span></em>, <em class="sig-param"><span class="n">drvmax</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">drvstep</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'Powell'</span></em>, <em class="sig-param"><span class="n">nmc</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">suffix</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#RVM.measure_binary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.RVM.measure_binary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.ccf.RVM.measure_pw">
<code class="sig-name descname">measure_pw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">rv_grid</span><span class="o">=</span><span class="default_value">array([- 600., - 587.87878788, - 575.75757576, - 563.63636364, - 551.51515152, - 539.39393939, - 527.27272727, - 515.15151515, - 503.03030303, - 490.90909091, - 478.78787879, - 466.66666667, - 454.54545455, - 442.42424242, - 430.3030303, - 418.18181818, - 406.06060606, - 393.93939394, - 381.81818182, - 369.6969697, - 357.57575758, - 345.45454545, - 333.33333333, - 321.21212121, - 309.09090909, - 296.96969697, - 284.84848485, - 272.72727273, - 260.60606061, - 248.48484848, - 236.36363636, - 224.24242424, - 212.12121212, - 200., - 187.87878788, - 175.75757576, - 163.63636364, - 151.51515152, - 139.39393939, - 127.27272727, - 115.15151515, - 103.03030303, - 90.90909091, - 78.78787879, - 66.66666667, - 54.54545455, - 42.42424242, - 30.3030303, - 18.18181818, - 6.06060606, 6.06060606, 18.18181818, 30.3030303, 42.42424242, 54.54545455, 66.66666667, 78.78787879, 90.90909091, 103.03030303, 115.15151515, 127.27272727, 139.39393939, 151.51515152, 163.63636364, 175.75757576, 187.87878788, 200., 212.12121212, 224.24242424, 236.36363636, 248.48484848, 260.60606061, 272.72727273, 284.84848485, 296.96969697, 309.09090909, 321.21212121, 333.33333333, 345.45454545, 357.57575758, 369.6969697, 381.81818182, 393.93939394, 406.06060606, 418.18181818, 430.3030303, 442.42424242, 454.54545455, 466.66666667, 478.78787879, 490.90909091, 503.03030303, 515.15151515, 527.27272727, 539.39393939, 551.51515152, 563.63636364, 575.75757576, 587.87878788, 600.])</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'BFGS'</span></em>, <em class="sig-param"><span class="n">pw</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#RVM.measure_pw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.RVM.measure_pw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.ccf.RVM.mock_binary_spectrum">
<code class="sig-name descname">mock_binary_spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imod1</span></em>, <em class="sig-param"><span class="n">imod2</span></em>, <em class="sig-param"><span class="n">rv1</span></em>, <em class="sig-param"><span class="n">drv</span></em>, <em class="sig-param"><span class="n">eta</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#RVM.mock_binary_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.RVM.mock_binary_spectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.ccf.RVM.reproduce_spectrum_binary">
<code class="sig-name descname">reproduce_spectrum_binary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rvr</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#RVM.reproduce_spectrum_binary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.RVM.reproduce_spectrum_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>reproduce the spectrum (binary)</p>
</dd></dl>

<dl class="py method">
<dt id="laspec.ccf.RVM.reproduce_spectrum_single">
<code class="sig-name descname">reproduce_spectrum_single</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rvr</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#RVM.reproduce_spectrum_single"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.RVM.reproduce_spectrum_single" title="Permalink to this definition">¶</a></dt>
<dd><p>reproduce the spectrum (single)</p>
</dd></dl>

<dl class="py method">
<dt id="laspec.ccf.RVM.shrink">
<code class="sig-name descname">shrink</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nmod</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'top'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#RVM.shrink"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.RVM.shrink" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.calculate_local_variance">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">calculate_local_variance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">flux</span></em>, <em class="sig-param"><span class="n">npix_lv</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/laspec/ccf.html#calculate_local_variance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.calculate_local_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate local variance</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.calculate_local_variance_multi">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">calculate_local_variance_multi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">flux</span></em>, <em class="sig-param"><span class="n">npix_lv</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">n_jobs</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">10</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/laspec/ccf.html#calculate_local_variance_multi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.calculate_local_variance_multi" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate local variance</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.respw_cost">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">respw_cost</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rv</span></em>, <em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">wave_mod</span></em>, <em class="sig-param"><span class="n">flux_mod</span></em>, <em class="sig-param"><span class="n">pw</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#respw_cost"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.respw_cost" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.ccf.respw_rvgrid">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">respw_rvgrid</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">wave_mod</span></em>, <em class="sig-param"><span class="n">flux_mod</span></em>, <em class="sig-param"><span class="n">pw</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">rv_grid</span><span class="o">=</span><span class="default_value">array([- 500, - 490, - 480, - 470, - 460, - 450, - 440, - 430, - 420, - 410, - 400, - 390, - 380, - 370, - 360, - 350, - 340, - 330, - 320, - 310, - 300, - 290, - 280, - 270, - 260, - 250, - 240, - 230, - 220, - 210, - 200, - 190, - 180, - 170, - 160, - 150, - 140, - 130, - 120, - 110, - 100, - 90, - 80, - 70, - 60, - 50, - 40, - 30, - 20, - 10, 0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500])</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#respw_rvgrid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.respw_rvgrid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.ccf.sinebell">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">sinebell</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">index</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#sinebell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.sinebell" title="Permalink to this definition">¶</a></dt>
<dd><p>sine bell to left &amp; right end of spectra</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.sinebell_like">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">sinebell_like</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">index</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#sinebell_like"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.sinebell_like" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.ccf.test_lmfit">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">test_lmfit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#test_lmfit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.test_lmfit" title="Permalink to this definition">¶</a></dt>
<dd><p>load data</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.test_new_rvm">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">test_new_rvm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#test_new_rvm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.test_new_rvm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.ccf.test_sinebell">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">test_sinebell</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#test_sinebell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.test_sinebell" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.ccf.test_sinebell2">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">test_sinebell2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#test_sinebell2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.test_sinebell2" title="Permalink to this definition">¶</a></dt>
<dd><p>load data</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.test_xcorr_rvgrid">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">test_xcorr_rvgrid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#test_xcorr_rvgrid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.test_xcorr_rvgrid" title="Permalink to this definition">¶</a></dt>
<dd><p>load data</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.wcov">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">wcov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x1</span></em>, <em class="sig-param"><span class="n">x2</span></em>, <em class="sig-param"><span class="n">w</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#wcov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.wcov" title="Permalink to this definition">¶</a></dt>
<dd><p>weighted covariance</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.wmean">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">wmean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">w</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#wmean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.wmean" title="Permalink to this definition">¶</a></dt>
<dd><p>weighted mean</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.wxcorr">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">wxcorr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x1</span></em>, <em class="sig-param"><span class="n">x2</span></em>, <em class="sig-param"><span class="n">w</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#wxcorr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.wxcorr" title="Permalink to this definition">¶</a></dt>
<dd><p>weighted cross-correlation</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.wxcorr_rvgrid">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">wxcorr_rvgrid</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">wave_mod</span></em>, <em class="sig-param"><span class="n">flux_mod</span></em>, <em class="sig-param"><span class="n">rv_grid</span><span class="o">=</span><span class="default_value">array([- 500, - 490, - 480, - 470, - 460, - 450, - 440, - 430, - 420, - 410, - 400, - 390, - 380, - 370, - 360, - 350, - 340, - 330, - 320, - 310, - 300, - 290, - 280, - 270, - 260, - 250, - 240, - 230, - 220, - 210, - 200, - 190, - 180, - 170, - 160, - 150, - 140, - 130, - 120, - 110, - 100, - 90, - 80, - 70, - 60, - 50, - 40, - 30, - 20, - 10, 0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500])</span></em>, <em class="sig-param"><span class="n">w_mod</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w_obs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#wxcorr_rvgrid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.wxcorr_rvgrid" title="Permalink to this definition">¶</a></dt>
<dd><p>weighted cross-correlation method
Interpolate a model spectrum with different RV and cross-correlate with
the observed spectrum, return the CCF on the RV grid.</p>
<dl class="simple">
<dt>wave_obs: array</dt><dd><p>wavelength of observed spectrum (normalized)</p>
</dd>
<dt>flux_obs: array</dt><dd><p>flux of observed spectrum</p>
</dd>
<dt>wave_mod: array</dt><dd><p>wavelength of model spectrum (normalized)</p>
</dd>
<dt>flux_mod:</dt><dd><p>flux of model spectrum</p>
</dd>
<dt>mask_obs:</dt><dd><p>True for bad pixels</p>
</dd>
<dt>rv_grid:</dt><dd><p>km/s RV grid</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.wxcorr_rvgrid_binary">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">wxcorr_rvgrid_binary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">wave_mod1</span></em>, <em class="sig-param"><span class="n">flux_mod1</span></em>, <em class="sig-param"><span class="n">wave_mod2</span></em>, <em class="sig-param"><span class="n">flux_mod2</span></em>, <em class="sig-param"><span class="n">flux_err</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rv1_init</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">eta_init</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">eta_lim</span><span class="o">=</span><span class="default_value">(0.1, 1.2)</span></em>, <em class="sig-param"><span class="n">drvmax</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">drvstep</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">w_obs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'Powell'</span></em>, <em class="sig-param"><span class="n">nmc</span><span class="o">=</span><span class="default_value">100</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#wxcorr_rvgrid_binary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.wxcorr_rvgrid_binary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.ccf.wxcorr_spec">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">wxcorr_spec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rv</span></em>, <em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">wave_mod</span></em>, <em class="sig-param"><span class="n">flux_mod</span></em>, <em class="sig-param"><span class="n">w_mod</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w_obs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#wxcorr_spec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.wxcorr_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>weighted cross correlation of two spectra</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.wxcorr_spec_binary">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">wxcorr_spec_binary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rv1</span></em>, <em class="sig-param"><span class="n">rv2</span></em>, <em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">wave_mod1</span></em>, <em class="sig-param"><span class="n">flux_mod1</span></em>, <em class="sig-param"><span class="n">wave_mod2</span></em>, <em class="sig-param"><span class="n">flux_mod2</span></em>, <em class="sig-param"><span class="n">w_obs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#wxcorr_spec_binary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.wxcorr_spec_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>weighted cross correlation of two spectra
.. note:: w_mod is not supported in this case</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.wxcorr_spec_cost">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">wxcorr_spec_cost</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rv</span></em>, <em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">wave_mod</span></em>, <em class="sig-param"><span class="n">flux_mod</span></em>, <em class="sig-param"><span class="n">w_mod</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w_obs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#wxcorr_spec_cost"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.wxcorr_spec_cost" title="Permalink to this definition">¶</a></dt>
<dd><p>the negative of wxcorr_spec, used as cost function for minimiztion</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.wxcorr_spec_cost_binary">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">wxcorr_spec_cost_binary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rv1_rv2_eta</span></em>, <em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">wave_mod1</span></em>, <em class="sig-param"><span class="n">flux_mod1</span></em>, <em class="sig-param"><span class="n">wave_mod2</span></em>, <em class="sig-param"><span class="n">flux_mod2</span></em>, <em class="sig-param"><span class="n">w_obs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eta_lim</span><span class="o">=</span><span class="default_value">(0.1, 1.2)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#wxcorr_spec_cost_binary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.wxcorr_spec_cost_binary" title="Permalink to this definition">¶</a></dt>
<dd><p>the negative of wxcorr_spec, used as cost function for minimiztion</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.wxcorr_spec_twin">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">wxcorr_spec_twin</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rv1</span></em>, <em class="sig-param"><span class="n">drv</span></em>, <em class="sig-param"><span class="n">eta</span></em>, <em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">wave_mod</span></em>, <em class="sig-param"><span class="n">flux_mod</span></em>, <em class="sig-param"><span class="n">w_obs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#wxcorr_spec_twin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.wxcorr_spec_twin" title="Permalink to this definition">¶</a></dt>
<dd><p>weighted cross correlation of two spectra
.. note:: w_mod is not supported in this case</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.ccf.xcorr_rvgrid">
<code class="sig-prename descclassname">laspec.ccf.</code><code class="sig-name descname">xcorr_rvgrid</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave_obs</span></em>, <em class="sig-param"><span class="n">flux_obs</span></em>, <em class="sig-param"><span class="n">wave_mod</span></em>, <em class="sig-param"><span class="n">flux_mod</span></em>, <em class="sig-param"><span class="n">mask_obs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rv_grid</span><span class="o">=</span><span class="default_value">array([- 500, - 490, - 480, - 470, - 460, - 450, - 440, - 430, - 420, - 410, - 400, - 390, - 380, - 370, - 360, - 350, - 340, - 330, - 320, - 310, - 300, - 290, - 280, - 270, - 260, - 250, - 240, - 230, - 220, - 210, - 200, - 190, - 180, - 170, - 160, - 150, - 140, - 130, - 120, - 110, - 100, - 90, - 80, - 70, - 60, - 50, - 40, - 30, - 20, - 10, 0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500])</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/ccf.html#xcorr_rvgrid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.ccf.xcorr_rvgrid" title="Permalink to this definition">¶</a></dt>
<dd><p>a naive cross-correlation method
Interpolate a model spectrum with different RV and cross-correlate with
the observed spectrum, return the CCF on the RV grid.</p>
<dl class="simple">
<dt>wave_obs: array</dt><dd><p>wavelength of observed spectrum (normalized)</p>
</dd>
<dt>flux_obs: array</dt><dd><p>flux of observed spectrum</p>
</dd>
<dt>wave_mod: array</dt><dd><p>wavelength of model spectrum (normalized)</p>
</dd>
<dt>flux_mod:</dt><dd><p>flux of model spectrum</p>
</dd>
<dt>mask_obs:</dt><dd><p>True for bad pixels</p>
</dd>
<dt>rv_grid:</dt><dd><p>km/s RV grid</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-laspec.convolution">
<span id="laspec-convolution-module"></span><h2>laspec.convolution module<a class="headerlink" href="#module-laspec.convolution" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="laspec.convolution.conv_spec">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">conv_spec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">flux</span></em>, <em class="sig-param"><span class="n">R_hi</span><span class="o">=</span><span class="default_value">2000.0</span></em>, <em class="sig-param"><span class="n">R_lo</span><span class="o">=</span><span class="default_value">500.0</span></em>, <em class="sig-param"><span class="n">over_sample_additional</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">gaussian_kernel_sigma_num</span><span class="o">=</span><span class="default_value">5.0</span></em>, <em class="sig-param"><span class="n">wave_new</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">wave_new_oversample</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">return_type</span><span class="o">=</span><span class="default_value">'array'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#conv_spec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.conv_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>to convolve high-R spectrum to low-R spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<em>array</em>) – wavelength</p></li>
<li><p><strong>flux</strong> (<em>array</em>) – flux array</p></li>
<li><p><strong>R_hi</strong> (<em>float</em><em> or </em><em>function</em>) – higher resolution</p></li>
<li><p><strong>R_lo</strong> (<em>float</em><em> or </em><em>function</em>) – lower resolution</p></li>
<li><p><strong>over_sample_additional</strong> (<em>float</em>) – additional over-sample rate</p></li>
<li><p><strong>gaussian_kernel_sigma_num</strong> (<em>float</em>) – the gaussian kernel width in terms of sigma</p></li>
<li><p><strong>wave_new</strong> (<em>None</em><em> or </em><em>float</em><em> or </em><em>array</em>) – if None: wave_new auto-generated using wave_new_oversample
if float: this specifies the over-sample rate
if voctor: this specifies the new wave_new array</p></li>
<li><p><strong>wave_new_oversample</strong> – if wave_new is None, use auto-generated wave_new_oversample</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – if True, print the details on the screen</p></li>
<li><p><strong>return_type</strong> (<em>string</em>) – if ‘array’: return wave and flux as array
if ‘table’: retrun spec object</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>wave_new, flux_new OR Table([wave, flux])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.convolution.find_R_for_wave_array">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">find_R_for_wave_array</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#find_R_for_wave_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.find_R_for_wave_array" title="Permalink to this definition">¶</a></dt>
<dd><p>find the R of wavelength array (sampling resolution array)</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.convolution.find_R_max_for_wave_array">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">find_R_max_for_wave_array</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#find_R_max_for_wave_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.find_R_max_for_wave_array" title="Permalink to this definition">¶</a></dt>
<dd><p>find the maximum sampling resolution of a given wavelength array</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.convolution.find_Rgk">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">find_Rgk</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">R_hi</span><span class="o">=</span><span class="default_value">2000.0</span></em>, <em class="sig-param"><span class="n">R_lo</span><span class="o">=</span><span class="default_value">500.0</span></em>, <em class="sig-param"><span class="n">over_sample</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#find_Rgk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.find_Rgk" title="Permalink to this definition">¶</a></dt>
<dd><p>find Rgk as a function of wavelength</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>R_hi</strong> (<em>float</em><em> or </em><em>funtion</em>) – higher resolution (as a function of wavelength)</p></li>
<li><p><strong>R_lo</strong> (<em>float</em><em> or </em><em>funtion</em>) – lower resolution (as a function of wavelength)</p></li>
<li><p><strong>over_sample</strong> (<em>float</em>) – over-sampled resolution, default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Rgk</strong> – Gaussian Kernel resolution as a function of wavelength</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.convolution.find_delta_lambda_for_wave_array">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">find_delta_lambda_for_wave_array</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#find_delta_lambda_for_wave_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.find_delta_lambda_for_wave_array" title="Permalink to this definition">¶</a></dt>
<dd><p>find the delta_lambda of wavelength array (delta_lambda array)</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.convolution.find_delta_lambda_min_for_wave_array">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">find_delta_lambda_min_for_wave_array</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#find_delta_lambda_min_for_wave_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.find_delta_lambda_min_for_wave_array" title="Permalink to this definition">¶</a></dt>
<dd><p>find the minimum delta_lambda of a given wavelength array</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.convolution.fwhm2resolution">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">fwhm2resolution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fwhm</span></em>, <em class="sig-param"><span class="n">wave</span><span class="o">=</span><span class="default_value">5000.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#fwhm2resolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.fwhm2resolution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.convolution.fwhm2sigma">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">fwhm2sigma</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fwhm</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#fwhm2sigma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.fwhm2sigma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.convolution.generate_gaussian_kernel_array">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">generate_gaussian_kernel_array</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">over_sample_Rgk</span></em>, <em class="sig-param"><span class="n">sigma_num</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#generate_gaussian_kernel_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.generate_gaussian_kernel_array" title="Permalink to this definition">¶</a></dt>
<dd><p>generate gaussian kernel array according to over_sample_Rgk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>over_sample_Rgk</strong> (<em>float</em>) – over_sample rate</p></li>
<li><p><strong>sigma_num</strong> (<em>float</em>) – 1 sigma of the Gaussian = sigma_num pixels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>normalized gaussian array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.convolution.generate_wave_array_R">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">generate_wave_array_R</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave_start</span></em>, <em class="sig-param"><span class="n">wave_stop</span></em>, <em class="sig-param"><span class="n">R</span><span class="o">=</span><span class="default_value">2000.0</span></em>, <em class="sig-param"><span class="n">over_sample</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">wave_test_step</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#generate_wave_array_R"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.generate_wave_array_R" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a wavelength array matching the given R</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave_start</strong> (<em>float</em>) – start from this wavelength</p></li>
<li><p><strong>wave_stop</strong> (<em>float</em>) – stop at this wavelength</p></li>
<li><p><strong>R</strong> (<em>float</em><em> or </em><em>function</em>) – specify a fixed R or specify R as a function of wavelength</p></li>
<li><p><strong>over_sample</strong> (<em>float</em>) – over-sampling rate, default is 1.</p></li>
<li><p><strong>wave_test_step</strong> – used to determing the wave_step_min</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>wave</strong> – an array matching the given R</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">R</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="mf">0.2</span><span class="o">*</span><span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave_array_R</span> <span class="o">=</span> <span class="n">generate_wave_array_R</span><span class="p">(</span><span class="mf">4000.</span><span class="p">,</span> <span class="mf">5000.</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="laspec.convolution.generate_wave_array_delta_lambda">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">generate_wave_array_delta_lambda</code><span class="sig-paren">(</span><em class="sig-param">wave_start</em>, <em class="sig-param">wave_stop</em>, <em class="sig-param">delta_lambda=&lt;function &lt;lambda&gt;&gt;</em>, <em class="sig-param">over_sample=1.0</em>, <em class="sig-param">wave_test_step=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#generate_wave_array_delta_lambda"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.generate_wave_array_delta_lambda" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>generate a wavelength array matching the given delta_lambda</dt><dd><p>(delta_lambda given as a fixed number or a function)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave_start</strong> (<em>float</em>) – where the wavelength starts</p></li>
<li><p><strong>wave_stop</strong> (<em>float</em>) – where the wavelength stops</p></li>
<li><p><strong>delta_lambda</strong> (<em>float</em><em> or </em><em>function</em>) – specifies the delta_lambda as a fixed number or a function of wavelength</p></li>
<li><p><strong>over_sample</strong> (<em>float</em>) – over-sampling</p></li>
<li><p><strong>wave_test_step</strong> (<em>float</em>) – tests for the smallest wave_guess step</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>wave_guess</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">dl</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="mf">0.002</span><span class="o">*</span><span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave_array_dl</span> <span class="o">=</span> <span class="n">generate_wave_array_delta_lambda</span><span class="p">(</span><span class="mf">4000.</span><span class="p">,</span> <span class="mf">5000.</span><span class="p">,</span> <span class="n">dl</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="laspec.convolution.normalized_gaussian_array">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">normalized_gaussian_array</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">b</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">c</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#normalized_gaussian_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.normalized_gaussian_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.convolution.read_phoenix_sun">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">read_phoenix_sun</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#read_phoenix_sun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.read_phoenix_sun" title="Permalink to this definition">¶</a></dt>
<dd><p>read PHOENIX synthetic spectrum for the Sun</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.convolution.resolution2fwhm">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">resolution2fwhm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">wave</span><span class="o">=</span><span class="default_value">5000.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#resolution2fwhm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.resolution2fwhm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.convolution.sigma2fwhm">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">sigma2fwhm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sigma</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#sigma2fwhm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.sigma2fwhm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.convolution.test_conv_phoenix_sun">
<code class="sig-prename descclassname">laspec.convolution.</code><code class="sig-name descname">test_conv_phoenix_sun</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/convolution.html#test_conv_phoenix_sun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.convolution.test_conv_phoenix_sun" title="Permalink to this definition">¶</a></dt>
<dd><p>testing convolving PHOENIX synthetic spectrum for the Sun</p>
</dd></dl>

</div>
<div class="section" id="module-laspec.core">
<span id="laspec-core-module"></span><h2>laspec.core module<a class="headerlink" href="#module-laspec.core" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="laspec.core.wmean">
<code class="sig-prename descclassname">laspec.core.</code><code class="sig-name descname">wmean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">w</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/core.html#wmean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.core.wmean" title="Permalink to this definition">¶</a></dt>
<dd><p>weighted mean</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.core.wstd">
<code class="sig-prename descclassname">laspec.core.</code><code class="sig-name descname">wstd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">w</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/core.html#wstd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.core.wstd" title="Permalink to this definition">¶</a></dt>
<dd><p>Weighted standard deviation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – data</p></li>
<li><p><strong>w</strong> (<em>array</em>) – weights</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>wstd</em></p></li>
<li><p><em>Ref</em></p></li>
<li><p><em>—</em></p></li>
<li><p><strong>https</strong> (<em>//www.itl.nist.gov/div898/software/dataplot/refman2/ch2/weightsd.pdf</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-laspec.fof">
<span id="laspec-fof-module"></span><h2>laspec.fof module<a class="headerlink" href="#module-laspec.fof" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="laspec.fof.d_a">
<code class="sig-prename descclassname">laspec.fof.</code><code class="sig-name descname">d_a</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">l1</span></em>, <em class="sig-param"><span class="n">b1</span></em>, <em class="sig-param"><span class="n">l2</span></em>, <em class="sig-param"><span class="n">b2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/fof.html#d_a"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.fof.d_a" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.fof.ezfof">
<code class="sig-prename descclassname">laspec.fof.</code><code class="sig-name descname">ezfof</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coord</span></em>, <em class="sig-param"><span class="n">sep</span><span class="o">=</span><span class="default_value">5</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/fof.html#ezfof"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.fof.ezfof" title="Permalink to this definition">¶</a></dt>
<dd><p>mark the group ids</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coord</strong> – SkyCoord</p></li>
<li><p><strong>sep</strong> – separation in deg</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>group id</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>gid</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.fof.fof">
<code class="sig-prename descclassname">laspec.fof.</code><code class="sig-name descname">fof</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_min</span></em>, <em class="sig-param"><span class="n">n_max</span></em>, <em class="sig-param"><span class="n">lk</span></em>, <em class="sig-param"><span class="n">distance</span></em>, <em class="sig-param"><span class="n">sample_size</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/fof.html#fof"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.fof.fof" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.fof.two_d">
<code class="sig-prename descclassname">laspec.fof.</code><code class="sig-name descname">two_d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ra</span></em>, <em class="sig-param"><span class="n">dec</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/fof.html#two_d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.fof.two_d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-laspec.helper">
<span id="laspec-helper-module"></span><h2>laspec.helper module<a class="headerlink" href="#module-laspec.helper" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="laspec.helper.laspec_path">
<code class="sig-prename descclassname">laspec.helper.</code><code class="sig-name descname">laspec_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/helper.html#laspec_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.helper.laspec_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.helper.stilts_path">
<code class="sig-prename descclassname">laspec.helper.</code><code class="sig-name descname">stilts_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/helper.html#stilts_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.helper.stilts_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.helper.test">
<code class="sig-prename descclassname">laspec.helper.</code><code class="sig-name descname">test</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/helper.html#test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.helper.test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-laspec.interpolate">
<span id="laspec-interpolate-module"></span><h2>laspec.interpolate module<a class="headerlink" href="#module-laspec.interpolate" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="laspec.interpolate.Interp1q">
<em class="property">class </em><code class="sig-prename descclassname">laspec.interpolate.</code><code class="sig-name descname">Interp1q</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'linear'</span></em>, <em class="sig-param"><span class="n">fill_value</span><span class="o">=</span><span class="default_value">nan</span></em>, <em class="sig-param"><span class="n">cushion</span><span class="o">=</span><span class="default_value">100000.0</span></em>, <em class="sig-param"><span class="n">issorted</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/interpolate.html#Interp1q"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.interpolate.Interp1q" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

</div>
<div class="section" id="module-laspec.lamost">
<span id="laspec-lamost-module"></span><h2>laspec.lamost module<a class="headerlink" href="#module-laspec.lamost" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="laspec.lamost.lamost_filepath">
<code class="sig-prename descclassname">laspec.lamost.</code><code class="sig-name descname">lamost_filepath</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">planid</span></em>, <em class="sig-param"><span class="n">mjd</span></em>, <em class="sig-param"><span class="n">spid</span></em>, <em class="sig-param"><span class="n">fiberid</span></em>, <em class="sig-param"><span class="n">dirpath</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">extname</span><span class="o">=</span><span class="default_value">'.fits'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/lamost.html#lamost_filepath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.lamost.lamost_filepath" title="Permalink to this definition">¶</a></dt>
<dd><p>generate file path of a LAMOST spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>planid</strong> (<em>string</em>) – planid</p></li>
<li><p><strong>mjd</strong> (<em>5-digit integer</em>) – mjd (use lmjd rather than mjd for DR3 and after!)</p></li>
<li><p><strong>spid</strong> (<em>2-digit integer</em>) – spid, the number of the spectrogragh</p></li>
<li><p><strong>fiberid</strong> (<em>3-digit integer</em>) – fiberid</p></li>
<li><p><strong>dirpath</strong> (<em>string</em>) – the root directory for storing spectra.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>filepath</strong> – the path of root dir of directory (prefix).
if un-specified, return file name.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.lamost.lamost_filepath_med">
<code class="sig-prename descclassname">laspec.lamost.</code><code class="sig-name descname">lamost_filepath_med</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">planid</span></em>, <em class="sig-param"><span class="n">mjd</span></em>, <em class="sig-param"><span class="n">spid</span></em>, <em class="sig-param"><span class="n">fiberid</span></em>, <em class="sig-param"><span class="n">dirpath</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">extname</span><span class="o">=</span><span class="default_value">'.fits'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/lamost.html#lamost_filepath_med"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.lamost.lamost_filepath_med" title="Permalink to this definition">¶</a></dt>
<dd><p>generate file path of a LAMOST spectrum (medium resolution)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>planid</strong> (<em>string</em>) – planid</p></li>
<li><p><strong>mjd</strong> (<em>5-digit integer</em>) – mjd (use lmjd rather than mjd for DR3 and after!)</p></li>
<li><p><strong>spid</strong> (<em>2-digit integer</em>) – spid, the number of the spectrogragh</p></li>
<li><p><strong>fiberid</strong> (<em>3-digit integer</em>) – fiberid</p></li>
<li><p><strong>dirpath</strong> (<em>string</em>) – the root directory for storing spectra.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>filepath</strong> – the path of root dir of directory (prefix).
if un-specified, return file name.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.lamost.sdss_filepath">
<code class="sig-prename descclassname">laspec.lamost.</code><code class="sig-name descname">sdss_filepath</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">plate</span></em>, <em class="sig-param"><span class="n">mjd</span></em>, <em class="sig-param"><span class="n">fiberid</span></em>, <em class="sig-param"><span class="n">dirpath</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">extname</span><span class="o">=</span><span class="default_value">'.fits'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/lamost.html#sdss_filepath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.lamost.sdss_filepath" title="Permalink to this definition">¶</a></dt>
<dd><p>generate file path of a LAMOST spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plate</strong> (<em>string</em>) – plate</p></li>
<li><p><strong>mjd</strong> (<em>5-digit integer</em>) – mjd (use lmjd rather than mjd for DR3 and after!)</p></li>
<li><p><strong>fiberid</strong> (<em>4-digit integer</em>) – fiberid</p></li>
<li><p><strong>dirpath</strong> (<em>string</em>) – the root directory for storing spectra.</p></li>
<li><p><strong>extname</strong> (<em>string</em>) – in case that users want to synthesize other data format</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>filepath</strong> – the path of root dir of directory (prefix).
if un-specified, return file name.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-laspec.light_curve">
<span id="laspec-light-curve-module"></span><h2>laspec.light_curve module<a class="headerlink" href="#module-laspec.light_curve" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="laspec.light_curve.read_lightcurve">
<code class="sig-prename descclassname">laspec.light_curve.</code><code class="sig-name descname">read_lightcurve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fp</span><span class="o">=</span><span class="default_value">'/Users/cham/projects/sb2/lightcurve/lc/lc488994.dat'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/light_curve.html#read_lightcurve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.light_curve.read_lightcurve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-laspec.line_index">
<span id="laspec-line-index-module"></span><h2>laspec.line_index module<a class="headerlink" href="#module-laspec.line_index" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="laspec.line_index.get_equivalent_width">
<code class="sig-prename descclassname">laspec.line_index.</code><code class="sig-name descname">get_equivalent_width</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line_indx_star</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/line_index.html#get_equivalent_width"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.line_index.get_equivalent_width" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.line_index.integrate_spectrum">
<code class="sig-prename descclassname">laspec.line_index.</code><code class="sig-name descname">integrate_spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">flux_norm</span></em>, <em class="sig-param"><span class="n">flux_norm_err</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nmc</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">wave_range</span><span class="o">=</span><span class="default_value">(6554, 6574)</span></em>, <em class="sig-param"><span class="n">suffix</span><span class="o">=</span><span class="default_value">'Ha'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/line_index.html#integrate_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.line_index.integrate_spectrum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.line_index.measure_line_index">
<code class="sig-prename descclassname">laspec.line_index.</code><code class="sig-name descname">measure_line_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">flux</span></em>, <em class="sig-param"><span class="n">flux_err</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">z</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">line_info</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_refit</span><span class="o">=</span><span class="default_value">(100, None)</span></em>, <em class="sig-param"><span class="n">filepath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_type</span><span class="o">=</span><span class="default_value">'dict'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/line_index.html#measure_line_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.line_index.measure_line_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure line index / EW and have it plotted</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<em>array-like</em>) – wavelength vector</p></li>
<li><p><strong>flux</strong> (<em>array-like</em>) – flux vector</p></li>
<li><p><strong>flux_err</strong> (<em>array-like</em>) – flux error vector (optional)
If un-specified, auto-generate an np.ones array</p></li>
<li><p><strong>mask</strong> (<em>array-like</em>) – andmask or ormask (optional)
If un-specified, auto-generate an np.ones array (evenly weighted)</p></li>
<li><p><strong>line_info</strong> (<em>dict</em>) – <p>information about spectral line, eg:
line_info_dib5780 = {‘line_center’:         5780,</p>
<blockquote>
<div><p>’line_range’:          (5775, 5785),
‘line_shoulder_left’:  (5755, 5775),
‘line_shoulder_right’: (5805, 5825)}</p>
</div></blockquote>
</p></li>
<li><p><strong>num_refit</strong> (<em>non-negative integer</em>) – number of refitting.
If 0, no refit will be performed
If positive, refits will be performed after adding normal random noise</p></li>
<li><p><strong>z</strong> (<em>float</em>) – redshift (only specify when z is large)</p></li>
<li><p><strong>filepath</strong> (<em>string</em>) – path of the diagnostic figure
if None, do nothing, else print diagnostic figure</p></li>
<li><p><strong>return_type</strong> (<em>string</em>) – ‘dict’ or ‘array’
if ‘array’, np.array(return dict.values())</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – if True, print details</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>line_indx</strong> – A dictionary type result of line index.
If any problem encountered, return the default result (filled with nan).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.line_index.measure_line_index_loopfun">
<code class="sig-prename descclassname">laspec.line_index.</code><code class="sig-name descname">measure_line_index_loopfun</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/line_index.html#measure_line_index_loopfun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.line_index.measure_line_index_loopfun" title="Permalink to this definition">¶</a></dt>
<dd><p>loopfun for measuring line index</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> (<em>string</em>) – path of the spec document</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>several line_indx</strong> – every line_indx is a dictionary type result of line index.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.line_index.measure_line_index_null_result">
<code class="sig-prename descclassname">laspec.line_index.</code><code class="sig-name descname">measure_line_index_null_result</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">return_type</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/line_index.html#measure_line_index_null_result"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.line_index.measure_line_index_null_result" title="Permalink to this definition">¶</a></dt>
<dd><p>generate default value (nan/False) when measurement fails
:returns:
:rtype: default value (nan/False)</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.line_index.measure_line_index_recover_spectrum">
<code class="sig-prename descclassname">laspec.line_index.</code><code class="sig-name descname">measure_line_index_recover_spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">norm</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/line_index.html#measure_line_index_recover_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.line_index.measure_line_index_recover_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>recover the fitted line profile from params</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<em>array-like</em>) – the wavelength to which the recovered flux correspond</p></li>
<li><p><strong>params</strong> (<em>5-element tuple</em>) – the 1 to 5 elements are:
mod_linear_slope
mod_linear_intercept
mod_gauss_amplitude
mod_gauss_center
mod_gauss_sigma</p></li>
<li><p><strong>norm</strong> (<em>bool</em>) – if True, linear model (continuum) is deprecated
else linear + Gaussian model is used</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.line_index.plot_equivalent_width_hist">
<code class="sig-prename descclassname">laspec.line_index.</code><code class="sig-name descname">plot_equivalent_width_hist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">EW_star</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/line_index.html#plot_equivalent_width_hist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.line_index.plot_equivalent_width_hist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.line_index.plot_line_indices">
<code class="sig-prename descclassname">laspec.line_index.</code><code class="sig-name descname">plot_line_indices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">EW_star</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/line_index.html#plot_line_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.line_index.plot_line_indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.line_index.save_image_line_indice">
<code class="sig-prename descclassname">laspec.line_index.</code><code class="sig-name descname">save_image_line_indice</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em>, <em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">flux</span></em>, <em class="sig-param"><span class="n">ind_range</span></em>, <em class="sig-param"><span class="n">cont_range</span></em>, <em class="sig-param"><span class="n">ind_shoulder</span></em>, <em class="sig-param"><span class="n">line_info</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/line_index.html#save_image_line_indice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.line_index.save_image_line_indice" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a line indice and save it as a .png document.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>string</em>) – path of the spec document</p></li>
<li><p><strong>wave</strong> (<em>array</em>) – wavelength vector</p></li>
<li><p><strong>flux</strong> (<em>array</em>) – flux vector</p></li>
<li><p><strong>ind_range</strong> (<em>array</em>) – bool indicating the middle range of a particular line</p></li>
<li><p><strong>cont_range</strong> (<em>array</em>) – continuum flux of the middle range derived from linear model</p></li>
<li><p><strong>ind_shoulder</strong> (<em>array</em>) – bool indicating the shoulder range of a particular line</p></li>
<li><p><strong>line_info</strong> (<em>dict</em>) – <p>information about spectral line, eg:
line_info_dib5780 = {‘line_center’:         5780,</p>
<blockquote>
<div><p>’line_range’:          (5775, 5785),
‘line_shoulder_left’:  (5755, 5775),
‘line_shoulder_right’: (5805, 5825)}</p>
</div></blockquote>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.line_index.test_">
<code class="sig-prename descclassname">laspec.line_index.</code><code class="sig-name descname">test_</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/line_index.html#test_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.line_index.test_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.line_index.test_measure_line_index">
<code class="sig-prename descclassname">laspec.line_index.</code><code class="sig-name descname">test_measure_line_index</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/line_index.html#test_measure_line_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.line_index.test_measure_line_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.line_index.walk_dir">
<code class="sig-prename descclassname">laspec.line_index.</code><code class="sig-name descname">walk_dir</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dirpath</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/line_index.html#walk_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.line_index.walk_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>enumerate all files under dirpath</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dirpath</strong> (<em>string</em>) – the directory to be walked in</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>filename</strong> – filepaths of all the spectra in finder dirpath</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-laspec.mpl">
<span id="laspec-mpl-module"></span><h2>laspec.mpl module<a class="headerlink" href="#module-laspec.mpl" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="laspec.mpl.set_cham">
<code class="sig-prename descclassname">laspec.mpl.</code><code class="sig-name descname">set_cham</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fontsize</span><span class="o">=</span><span class="default_value">15</span></em>, <em class="sig-param"><span class="n">xminor</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">yminor</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">latex</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mpl.html#set_cham"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mpl.set_cham" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.mpl.set_xminor">
<code class="sig-prename descclassname">laspec.mpl.</code><code class="sig-name descname">set_xminor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">b</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mpl.html#set_xminor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mpl.set_xminor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.mpl.set_yminor">
<code class="sig-prename descclassname">laspec.mpl.</code><code class="sig-name descname">set_yminor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">b</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mpl.html#set_yminor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mpl.set_yminor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-laspec.mrs">
<span id="laspec-mrs-module"></span><h2>laspec.mrs module<a class="headerlink" href="#module-laspec.mrs" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="laspec.mrs.MrsEpoch">
<em class="property">class </em><code class="sig-prename descclassname">laspec.mrs.</code><code class="sig-name descname">MrsEpoch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">speclist</span></em>, <em class="sig-param"><span class="n">specnames</span><span class="o">=</span><span class="default_value">('B', 'R')</span></em>, <em class="sig-param"><span class="n">epoch</span><span class="o">=</span><span class="default_value">- 1</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">norm_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsEpoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsEpoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>MRS epoch spcetrum</p>
<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.bjdmid">
<code class="sig-name descname">bjdmid</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.bjdmid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.dec">
<code class="sig-name descname">dec</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.dec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.epoch">
<code class="sig-name descname">epoch</code><em class="property"> = -1</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.epoch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsEpoch.exptime">
<em class="property">property </em><code class="sig-name descname">exptime</code><a class="headerlink" href="#laspec.mrs.MrsEpoch.exptime" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.fibermask">
<code class="sig-name descname">fibermask</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.fibermask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.fibertype">
<code class="sig-name descname">fibertype</code><em class="property"> = ''</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.fibertype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.filename">
<code class="sig-name descname">filename</code><em class="property"> = ''</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.filename" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.flux">
<code class="sig-name descname">flux</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.flux" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.flux_cont">
<code class="sig-name descname">flux_cont</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.flux_cont" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.flux_err">
<code class="sig-name descname">flux_err</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.flux_err" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.flux_norm">
<code class="sig-name descname">flux_norm</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.flux_norm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsEpoch.flux_norm_dbd">
<code class="sig-name descname">flux_norm_dbd</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsEpoch.flux_norm_dbd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsEpoch.flux_norm_dbd" title="Permalink to this definition">¶</a></dt>
<dd><p>return fixed flux_norm</p>
</dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.flux_norm_err">
<code class="sig-name descname">flux_norm_err</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.flux_norm_err" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.ivar">
<code class="sig-name descname">ivar</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.ivar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.ivar_norm">
<code class="sig-name descname">ivar_norm</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.ivar_norm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.jdbeg">
<code class="sig-name descname">jdbeg</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.jdbeg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.jdend">
<code class="sig-name descname">jdend</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.jdend" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.jdltt">
<code class="sig-name descname">jdltt</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.jdltt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.jdmid">
<code class="sig-name descname">jdmid</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.jdmid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.jdmid_delta">
<code class="sig-name descname">jdmid_delta</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.jdmid_delta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.lmjm">
<code class="sig-name descname">lmjm</code><em class="property"> = 0</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.lmjm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.mask">
<code class="sig-name descname">mask</code><em class="property"> = array([], dtype=int64)</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.norm_kwargs">
<code class="sig-name descname">norm_kwargs</code><em class="property"> = {}</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.norm_kwargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsEpoch.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">llim</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">norm_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsEpoch.normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsEpoch.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>normalize each spectrum with (optional) new settings</p>
</dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.nspec">
<code class="sig-name descname">nspec</code><em class="property"> = 0</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.nspec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.obsid">
<code class="sig-name descname">obsid</code><em class="property"> = 0</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.obsid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsEpoch.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsEpoch.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsEpoch.plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsEpoch.plot_cont">
<code class="sig-name descname">plot_cont</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsEpoch.plot_cont"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsEpoch.plot_cont" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsEpoch.plot_err">
<code class="sig-name descname">plot_err</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsEpoch.plot_err"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsEpoch.plot_err" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsEpoch.plot_norm">
<code class="sig-name descname">plot_norm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shift</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsEpoch.plot_norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsEpoch.plot_norm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsEpoch.plot_norm_err">
<code class="sig-name descname">plot_norm_err</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shift</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsEpoch.plot_norm_err"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsEpoch.plot_norm_err" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsEpoch.plot_norm_reduce">
<code class="sig-name descname">plot_norm_reduce</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shift</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsEpoch.plot_norm_reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsEpoch.plot_norm_reduce" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsEpoch.plot_reduce">
<code class="sig-name descname">plot_reduce</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsEpoch.plot_reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsEpoch.plot_reduce" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.ra">
<code class="sig-name descname">ra</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.ra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsEpoch.reduce">
<code class="sig-name descname">reduce</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave_new_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">'spline'</span></em>, <em class="sig-param"><span class="n">niter</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">rdc_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsEpoch.reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsEpoch.reduce" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave_new_list</strong> – new wavelength grid list that will be interpolated to</p></li>
<li><p><strong>norm_type</strong> – type of normalization</p></li>
<li><p><strong>niter</strong> – number of iteration in normalization</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>mer</strong> – reduced epoch spectrum</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#laspec.mrs.MrsEpoch" title="laspec.mrs.MrsEpoch">MrsEpoch</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.rv">
<code class="sig-name descname">rv</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.rv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.seeing">
<code class="sig-name descname">seeing</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.seeing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.snr">
<code class="sig-name descname">snr</code><em class="property"> = []</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.snr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.speclist">
<code class="sig-name descname">speclist</code><em class="property"> = []</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.speclist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.specnames">
<code class="sig-name descname">specnames</code><em class="property"> = []</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.specnames" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsEpoch.wave">
<code class="sig-name descname">wave</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsEpoch.wave" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsEpoch.wave_rv">
<code class="sig-name descname">wave_rv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rv</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsEpoch.wave_rv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsEpoch.wave_rv" title="Permalink to this definition">¶</a></dt>
<dd><p>return RV-corrected wavelength array
Parameter
———
rv:</p>
<blockquote>
<div><p>float, radial velocity [km/s]</p>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="laspec.mrs.MrsFits">
<em class="property">class </em><code class="sig-prename descclassname">laspec.mrs.</code><code class="sig-name descname">MrsFits</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsFits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsFits" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.io.fits.hdu.hdulist.HDUList</span></code></p>
<dl class="py method">
<dt id="laspec.mrs.MrsFits.epoch">
<em class="property">property </em><code class="sig-name descname">epoch</code><a class="headerlink" href="#laspec.mrs.MrsFits.epoch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsFits.get_all_epochs">
<code class="sig-name descname">get_all_epochs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">including_coadd</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">norm_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsFits.get_all_epochs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsFits.get_all_epochs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsFits.get_one_epoch">
<code class="sig-name descname">get_one_epoch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lmjm</span><span class="o">=</span><span class="default_value">84420148</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">norm_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsFits.get_one_epoch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsFits.get_one_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>get one epoch spec from fits</p>
</dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsFits.get_one_spec">
<code class="sig-name descname">get_one_spec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lmjm</span><span class="o">=</span><span class="default_value">'COADD'</span></em>, <em class="sig-param"><span class="n">band</span><span class="o">=</span><span class="default_value">'B'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsFits.get_one_spec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsFits.get_one_spec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsFits.hdunames">
<code class="sig-name descname">hdunames</code><em class="property"> = []</em><a class="headerlink" href="#laspec.mrs.MrsFits.hdunames" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsFits.isB">
<code class="sig-name descname">isB</code><em class="property"> = []</em><a class="headerlink" href="#laspec.mrs.MrsFits.isB" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsFits.isCoadd">
<code class="sig-name descname">isCoadd</code><em class="property"> = []</em><a class="headerlink" href="#laspec.mrs.MrsFits.isCoadd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsFits.isEpoch">
<code class="sig-name descname">isEpoch</code><em class="property"> = []</em><a class="headerlink" href="#laspec.mrs.MrsFits.isEpoch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsFits.isR">
<code class="sig-name descname">isR</code><em class="property"> = []</em><a class="headerlink" href="#laspec.mrs.MrsFits.isR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsFits.ls_epoch">
<em class="property">property </em><code class="sig-name descname">ls_epoch</code><a class="headerlink" href="#laspec.mrs.MrsFits.ls_epoch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsFits.ls_snr">
<em class="property">property </em><code class="sig-name descname">ls_snr</code><a class="headerlink" href="#laspec.mrs.MrsFits.ls_snr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsFits.nhdu">
<code class="sig-name descname">nhdu</code><em class="property"> = 0</em><a class="headerlink" href="#laspec.mrs.MrsFits.nhdu" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsFits.snr">
<em class="property">property </em><code class="sig-name descname">snr</code><a class="headerlink" href="#laspec.mrs.MrsFits.snr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsFits.ulmjm">
<code class="sig-name descname">ulmjm</code><em class="property"> = []</em><a class="headerlink" href="#laspec.mrs.MrsFits.ulmjm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="laspec.mrs.MrsSource">
<em class="property">class </em><code class="sig-prename descclassname">laspec.mrs.</code><code class="sig-name descname">MrsSource</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">norm_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSource" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
<p>array of MrsEpoch instances,</p>
<dl class="py method">
<dt id="laspec.mrs.MrsSource.bjdmid">
<em class="property">property </em><code class="sig-name descname">bjdmid</code><a class="headerlink" href="#laspec.mrs.MrsSource.bjdmid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSource.epoch">
<em class="property">property </em><code class="sig-name descname">epoch</code><a class="headerlink" href="#laspec.mrs.MrsSource.epoch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSource.getkwd">
<code class="sig-name descname">getkwd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">k</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSource.getkwd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSource.getkwd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSource.glob">
<em class="property">static </em><code class="sig-name descname">glob</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmt</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">norm_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSource.glob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSource.glob" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSource.jdltt">
<em class="property">property </em><code class="sig-name descname">jdltt</code><a class="headerlink" href="#laspec.mrs.MrsSource.jdltt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSource.jdmid">
<em class="property">property </em><code class="sig-name descname">jdmid</code><a class="headerlink" href="#laspec.mrs.MrsSource.jdmid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSource.mes">
<code class="sig-name descname">mes</code><em class="property"> = []</em><a class="headerlink" href="#laspec.mrs.MrsSource.mes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSource.name">
<code class="sig-name descname">name</code><em class="property"> = ''</em><a class="headerlink" href="#laspec.mrs.MrsSource.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSource.nepoch">
<em class="property">property </em><code class="sig-name descname">nepoch</code><a class="headerlink" href="#laspec.mrs.MrsSource.nepoch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSource.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">norm_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSource.normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSource.normalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSource.read">
<em class="property">static </em><code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fps</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">norm_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSource.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSource.read" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSource.rv">
<em class="property">property </em><code class="sig-name descname">rv</code><a class="headerlink" href="#laspec.mrs.MrsSource.rv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSource.shiftplot">
<code class="sig-name descname">shiftplot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shift</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSource.shiftplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSource.shiftplot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSource.snr">
<em class="property">property </em><code class="sig-name descname">snr</code><a class="headerlink" href="#laspec.mrs.MrsSource.snr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="laspec.mrs.MrsSpec">
<em class="property">class </em><code class="sig-prename descclassname">laspec.mrs.</code><code class="sig-name descname">MrsSpec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flux</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ivar</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">info</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">norm_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSpec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>MRS spectrum</p>
<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.bjdmid">
<code class="sig-name descname">bjdmid</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsSpec.bjdmid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.dec">
<code class="sig-name descname">dec</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsSpec.dec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.exptime">
<code class="sig-name descname">exptime</code><em class="property"> = 0</em><a class="headerlink" href="#laspec.mrs.MrsSpec.exptime" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.fibermask">
<code class="sig-name descname">fibermask</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsSpec.fibermask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.fibertype">
<code class="sig-name descname">fibertype</code><em class="property"> = ''</em><a class="headerlink" href="#laspec.mrs.MrsSpec.fibertype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.filename">
<code class="sig-name descname">filename</code><em class="property"> = ''</em><a class="headerlink" href="#laspec.mrs.MrsSpec.filename" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.flux">
<code class="sig-name descname">flux</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsSpec.flux" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.flux_cont">
<code class="sig-name descname">flux_cont</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsSpec.flux_cont" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.flux_err">
<code class="sig-name descname">flux_err</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsSpec.flux_err" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.flux_norm">
<code class="sig-name descname">flux_norm</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsSpec.flux_norm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.flux_norm_err">
<code class="sig-name descname">flux_norm_err</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsSpec.flux_norm_err" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSpec.from_hdu">
<em class="property">static </em><code class="sig-name descname">from_hdu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hdu</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">norm_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSpec.from_hdu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSpec.from_hdu" title="Permalink to this definition">¶</a></dt>
<dd><p>convert MRS HDU to spec</p>
</dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSpec.from_lrs">
<em class="property">static </em><code class="sig-name descname">from_lrs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fp_lrs</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">'spline'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">norm_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSpec.from_lrs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSpec.from_lrs" title="Permalink to this definition">¶</a></dt>
<dd><p>read from LRS fits file</p>
</dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSpec.from_mrs">
<em class="property">static </em><code class="sig-name descname">from_mrs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fp_mrs</span></em>, <em class="sig-param"><span class="n">hduname</span><span class="o">=</span><span class="default_value">'COADD_B'</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">norm_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSpec.from_mrs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSpec.from_mrs" title="Permalink to this definition">¶</a></dt>
<dd><p>read from MRS fits file</p>
</dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.indcr">
<code class="sig-name descname">indcr</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsSpec.indcr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.info">
<code class="sig-name descname">info</code><em class="property"> = {}</em><a class="headerlink" href="#laspec.mrs.MrsSpec.info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.isempty">
<code class="sig-name descname">isempty</code><em class="property"> = True</em><a class="headerlink" href="#laspec.mrs.MrsSpec.isempty" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.isnormalized">
<code class="sig-name descname">isnormalized</code><em class="property"> = False</em><a class="headerlink" href="#laspec.mrs.MrsSpec.isnormalized" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.ivar">
<code class="sig-name descname">ivar</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsSpec.ivar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.ivar_norm">
<code class="sig-name descname">ivar_norm</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsSpec.ivar_norm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.jdbeg">
<code class="sig-name descname">jdbeg</code><em class="property"> = 0</em><a class="headerlink" href="#laspec.mrs.MrsSpec.jdbeg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.jdend">
<code class="sig-name descname">jdend</code><em class="property"> = 0</em><a class="headerlink" href="#laspec.mrs.MrsSpec.jdend" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.jdltt">
<code class="sig-name descname">jdltt</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsSpec.jdltt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.jdmid">
<code class="sig-name descname">jdmid</code><em class="property"> = 0</em><a class="headerlink" href="#laspec.mrs.MrsSpec.jdmid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.lamplist">
<code class="sig-name descname">lamplist</code><em class="property"> = ''</em><a class="headerlink" href="#laspec.mrs.MrsSpec.lamplist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.lmjm">
<code class="sig-name descname">lmjm</code><em class="property"> = 0</em><a class="headerlink" href="#laspec.mrs.MrsSpec.lmjm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.lmjmlist">
<code class="sig-name descname">lmjmlist</code><em class="property"> = []</em><a class="headerlink" href="#laspec.mrs.MrsSpec.lmjmlist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.mask">
<code class="sig-name descname">mask</code><em class="property"> = array([], dtype=bool)</em><a class="headerlink" href="#laspec.mrs.MrsSpec.mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSpec.meta">
<code class="sig-name descname">meta</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSpec.meta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSpec.meta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.name">
<code class="sig-name descname">name</code><em class="property"> = ''</em><a class="headerlink" href="#laspec.mrs.MrsSpec.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.norm_kwargs">
<code class="sig-name descname">norm_kwargs</code><em class="property"> = {}</em><a class="headerlink" href="#laspec.mrs.MrsSpec.norm_kwargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.norm_type">
<code class="sig-name descname">norm_type</code><em class="property"> = None</em><a class="headerlink" href="#laspec.mrs.MrsSpec.norm_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSpec.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">llim</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">norm_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSpec.normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSpec.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>normalize spectrum with (optional) new settings</p>
</dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.obsid">
<code class="sig-name descname">obsid</code><em class="property"> = 0</em><a class="headerlink" href="#laspec.mrs.MrsSpec.obsid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSpec.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSpec.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSpec.plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSpec.plot_cont">
<code class="sig-name descname">plot_cont</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSpec.plot_cont"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSpec.plot_cont" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSpec.plot_err">
<code class="sig-name descname">plot_err</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSpec.plot_err"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSpec.plot_err" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSpec.plot_norm">
<code class="sig-name descname">plot_norm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shift</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSpec.plot_norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSpec.plot_norm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSpec.plot_norm_err">
<code class="sig-name descname">plot_norm_err</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shift</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSpec.plot_norm_err"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSpec.plot_norm_err" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.ra">
<code class="sig-name descname">ra</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsSpec.ra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSpec.reduce">
<code class="sig-name descname">reduce</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave_new</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rv</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">npix_cushion</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">cr</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">nsigma</span><span class="o">=</span><span class="default_value">(4, 8)</span></em>, <em class="sig-param"><span class="n">maxiter</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">'spline'</span></em>, <em class="sig-param"><span class="n">niter</span><span class="o">=</span><span class="default_value">3</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSpec.reduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSpec.reduce" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave_new</strong> – if specified, spectrum is interpolated to wave_new</p></li>
<li><p><strong>rv</strong> – if specified, radial velocity is corrected</p></li>
<li><p><strong>npix_cushion</strong> (<em>int</em>) – if speficied, cut the two ends</p></li>
<li><p><strong>cr</strong> – if True, remove cosmic rays using the <em>debad</em> function</p></li>
<li><p><strong>nsigma</strong> – sigma levels used in removing cosmic rays</p></li>
<li><p><strong>maxiter</strong> – max number of iterations used in removing cosmic rays</p></li>
<li><p><strong>norm_type</strong> – “spline” | None</p></li>
<li><p><strong>niter</strong> – number iterations in normalization</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>wave_new, flux_norm, flux_norm_err</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.rv">
<code class="sig-name descname">rv</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsSpec.rv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.seeing">
<code class="sig-name descname">seeing</code><em class="property"> = 0.0</em><a class="headerlink" href="#laspec.mrs.MrsSpec.seeing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.snr">
<code class="sig-name descname">snr</code><em class="property"> = 0</em><a class="headerlink" href="#laspec.mrs.MrsSpec.snr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.mrs.MrsSpec.wave">
<code class="sig-name descname">wave</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.mrs.MrsSpec.wave" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.mrs.MrsSpec.wave_rv">
<code class="sig-name descname">wave_rv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rv</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#MrsSpec.wave_rv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.MrsSpec.wave_rv" title="Permalink to this definition">¶</a></dt>
<dd><p>return RV-corrected wavelength array
Parameter
———
rv:</p>
<blockquote>
<div><p>float, radial velocity [km/s]</p>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="laspec.mrs.datetime2jd">
<code class="sig-prename descclassname">laspec.mrs.</code><code class="sig-name descname">datetime2jd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">datetime</span><span class="o">=</span><span class="default_value">'2018-10-24T05:07:06.0'</span></em>, <em class="sig-param"><span class="n">format</span><span class="o">=</span><span class="default_value">'isot'</span></em>, <em class="sig-param"><span class="n">tz_correction</span><span class="o">=</span><span class="default_value">8</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#datetime2jd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.datetime2jd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.mrs.debad">
<code class="sig-prename descclassname">laspec.mrs.</code><code class="sig-name descname">debad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">fluxnorm</span></em>, <em class="sig-param"><span class="n">nsigma</span><span class="o">=</span><span class="default_value">(4, 8)</span></em>, <em class="sig-param"><span class="n">mfarg</span><span class="o">=</span><span class="default_value">21</span></em>, <em class="sig-param"><span class="n">gfarg</span><span class="o">=</span><span class="default_value">(51, 9)</span></em>, <em class="sig-param"><span class="n">maskconv</span><span class="o">=</span><span class="default_value">7</span></em>, <em class="sig-param"><span class="n">maxiter</span><span class="o">=</span><span class="default_value">3</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#debad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.debad" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> – wavelength</p></li>
<li><p><strong>fluxnorm</strong> – normalized flux</p></li>
<li><p><strong>nsigma</strong> – lower &amp; upper sigma levels</p></li>
<li><p><strong>mfarg</strong> – median filter width / pixel</p></li>
<li><p><strong>gfarg</strong> – Gaussian filter length &amp; width / pixel</p></li>
<li><p><strong>maskconv</strong> – mask convolution –&gt; cushion</p></li>
<li><p><strong>maxiter</strong> – max iteration</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fluxnorm</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.mrs.eval_ltt">
<code class="sig-prename descclassname">laspec.mrs.</code><code class="sig-name descname">eval_ltt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ra</span><span class="o">=</span><span class="default_value">180.0</span></em>, <em class="sig-param"><span class="n">dec</span><span class="o">=</span><span class="default_value">40.0</span></em>, <em class="sig-param"><span class="n">jd</span><span class="o">=</span><span class="default_value">2456326.4583333</span></em>, <em class="sig-param"><span class="n">site</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#eval_ltt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.eval_ltt" title="Permalink to this definition">¶</a></dt>
<dd><p>evaluate the jd</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.mrs.test_meta">
<code class="sig-prename descclassname">laspec.mrs.</code><code class="sig-name descname">test_meta</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/mrs.html#test_meta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.mrs.test_meta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="laspec-neural-network-module">
<h2>laspec.neural_network module<a class="headerlink" href="#laspec-neural-network-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-laspec.nn">
<span id="laspec-nn-module"></span><h2>laspec.nn module<a class="headerlink" href="#module-laspec.nn" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="laspec.nn.NN">
<em class="property">class </em><code class="sig-prename descclassname">laspec.nn.</code><code class="sig-name descname">NN</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xtrain</span></em>, <em class="sig-param"><span class="n">ytrain</span></em>, <em class="sig-param"><span class="n">regression</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">usepca</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">n_components</span><span class="o">=</span><span class="default_value">0.99</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">mlp_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/nn.html#NN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.nn.NN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt id="laspec.nn.NN.pca">
<code class="sig-name descname">pca</code><em class="property"> = None</em><a class="headerlink" href="#laspec.nn.NN.pca" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.nn.NN.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xtest</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/nn.html#NN.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.nn.NN.predict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.nn.NN.predict_proba">
<code class="sig-name descname">predict_proba</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xtest</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/nn.html#NN.predict_proba"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.nn.NN.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.nn.NN.regression">
<code class="sig-name descname">regression</code><em class="property"> = True</em><a class="headerlink" href="#laspec.nn.NN.regression" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.nn.NN.regressor">
<code class="sig-name descname">regressor</code><em class="property"> = None</em><a class="headerlink" href="#laspec.nn.NN.regressor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.nn.NN.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/nn.html#NN.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.nn.NN.transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.nn.NN.usepca">
<code class="sig-name descname">usepca</code><em class="property"> = False</em><a class="headerlink" href="#laspec.nn.NN.usepca" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.nn.NN.xscaler">
<code class="sig-name descname">xscaler</code><em class="property"> = None</em><a class="headerlink" href="#laspec.nn.NN.xscaler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.nn.NN.xtest">
<code class="sig-name descname">xtest</code><em class="property"> = 0</em><a class="headerlink" href="#laspec.nn.NN.xtest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.nn.NN.xtrain">
<code class="sig-name descname">xtrain</code><em class="property"> = 0</em><a class="headerlink" href="#laspec.nn.NN.xtrain" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.nn.NN.yscaler">
<code class="sig-name descname">yscaler</code><em class="property"> = None</em><a class="headerlink" href="#laspec.nn.NN.yscaler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.nn.NN.ytest">
<code class="sig-name descname">ytest</code><em class="property"> = 0</em><a class="headerlink" href="#laspec.nn.NN.ytest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="laspec.nn.NN.ytrain">
<code class="sig-name descname">ytrain</code><em class="property"> = 0</em><a class="headerlink" href="#laspec.nn.NN.ytrain" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-laspec.normalization">
<span id="laspec-normalization-module"></span><h2>laspec.normalization module<a class="headerlink" href="#module-laspec.normalization" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="laspec.normalization.PolySmooth">
<em class="property">class </em><code class="sig-prename descclassname">laspec.normalization.</code><code class="sig-name descname">PolySmooth</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">deg</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">pw</span><span class="o">=</span><span class="default_value">2.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/normalization.html#PolySmooth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.normalization.PolySmooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py function">
<dt id="laspec.normalization.cost_poly">
<code class="sig-prename descclassname">laspec.normalization.</code><code class="sig-name descname">cost_poly</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">pw</span><span class="o">=</span><span class="default_value">2.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/normalization.html#cost_poly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.normalization.cost_poly" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.normalization.normalize_spectra_block">
<code class="sig-prename descclassname">laspec.normalization.</code><code class="sig-name descname">normalize_spectra_block</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">flux_block</span></em>, <em class="sig-param"><span class="n">norm_range</span></em>, <em class="sig-param"><span class="n">dwave</span></em>, <em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">(1e-06, 1e-06)</span></em>, <em class="sig-param"><span class="n">q</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">ivar_block</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eps</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">rsv_frac</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">n_jobs</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/normalization.html#normalize_spectra_block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.normalization.normalize_spectra_block" title="Permalink to this definition">¶</a></dt>
<dd><p>normalize multiple spectra using the same configuration
This is specially designed for TheKeenan</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<em>ndarray</em><em> (</em><em>n_pix</em><em>, </em><em>)</em>) – wavelegnth array</p></li>
<li><p><strong>flux_block</strong> (<em>ndarray</em><em> (</em><em>n_obs</em><em>, </em><em>n_pix</em><em>)</em>) – flux array</p></li>
<li><p><strong>norm_range</strong> (<em>tuple</em>) – a tuple consisting (wave_start, wave_stop)</p></li>
<li><p><strong>dwave</strong> (<em>float</em>) – binning width</p></li>
<li><p><strong>p</strong> (<em>tuple of 2 ps</em>) – smoothing parameter between 0 and 1:
0 -&gt; LS-straight line
1 -&gt; cubic spline interpolant</p></li>
<li><p><strong>q</strong> (<em>float in range of</em><em> [</em><em>0</em><em>, </em><em>100</em><em>]</em>) – percentile, between 0 and 1</p></li>
<li><p><strong>ivar_block</strong> (<em>ndarray</em><em> (</em><em>n_pix</em><em>, </em><em>) </em><em>| None</em>) – ivar array, default is None</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – the ivar threshold</p></li>
<li><p><strong>rsv_frac</strong> (<em>float</em>) – the fraction of pixels reserved in terms of std. default is 3.</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em>) – number of processes launched by joblib</p></li>
<li><p><strong>verbose</strong> (<em>int / bool</em>) – verbose level</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>flux_norm_block</strong> (<em>ndarray</em>) – normalized flux</p></li>
<li><p><strong>flux_cont_block</strong> (<em>ndarray</em>) – continuum flux</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.normalization.normalize_spectrum">
<code class="sig-prename descclassname">laspec.normalization.</code><code class="sig-name descname">normalize_spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">flux</span></em>, <em class="sig-param"><span class="n">norm_range</span></em>, <em class="sig-param"><span class="n">dwave</span></em>, <em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">(1e-06, 1e-06)</span></em>, <em class="sig-param"><span class="n">q</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">ivar</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eps</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">rsv_frac</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/normalization.html#normalize_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.normalization.normalize_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>A double smooth normalization of a spectrum</p>
<p>Converted from Chao Liu’s normSpectrum.m
Updated by Bo Zhang</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<em>ndarray</em><em> (</em><em>n_pix</em><em>, </em><em>)</em>) – wavelegnth array</p></li>
<li><p><strong>flux</strong> (<em>ndarray</em><em> (</em><em>n_pix</em><em>, </em><em>)</em>) – flux array</p></li>
<li><p><strong>norm_range</strong> (<em>tuple</em>) – a tuple consisting (wave_start, wave_stop)</p></li>
<li><p><strong>dwave</strong> (<em>float</em>) – binning width</p></li>
<li><p><strong>p</strong> (<em>tuple of 2 ps</em>) – smoothing parameter between 0 and 1:
0 -&gt; LS-straight line
1 -&gt; cubic spline interpolant</p></li>
<li><p><strong>q</strong> (<em>float in range of</em><em> [</em><em>0</em><em>, </em><em>100</em><em>]</em>) – percentile, between 0 and 1</p></li>
<li><p><strong>ivar</strong> (<em>ndarray</em><em> (</em><em>n_pix</em><em>, </em><em>) </em><em>| None</em>) – ivar array, default is None</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – the ivar threshold</p></li>
<li><p><strong>rsv_frac</strong> (<em>float</em>) – the fraction of pixels reserved in terms of std. default is 3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>flux_norm</strong> (<em>ndarray</em>) – normalized flux</p></li>
<li><p><strong>flux_cont</strong> (<em>ndarray</em>) – continuum flux</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flux_norm</span><span class="p">,</span> <span class="n">flux_cont</span> <span class="o">=</span> <span class="n">normalize_spectrum</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">wave</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="p">(</span><span class="mf">4000.</span><span class="p">,</span> <span class="mf">8000.</span><span class="p">),</span> <span class="mf">100.</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="mf">1E-8</span><span class="p">,</span> <span class="mf">1E-7</span><span class="p">),</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">rsv_frac</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="laspec.normalization.normalize_spectrum_general">
<code class="sig-prename descclassname">laspec.normalization.</code><code class="sig-name descname">normalize_spectrum_general</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">flux</span></em>, <em class="sig-param"><span class="n">norm_type</span><span class="o">=</span><span class="default_value">'spline'</span></em>, <em class="sig-param"><span class="n">deg</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">lu</span><span class="o">=</span><span class="default_value">(- 1, 4)</span></em>, <em class="sig-param"><span class="n">q</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">binwidth</span><span class="o">=</span><span class="default_value">100.0</span></em>, <em class="sig-param"><span class="n">niter</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">pw</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">1e-06</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/normalization.html#normalize_spectrum_general"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.normalization.normalize_spectrum_general" title="Permalink to this definition">¶</a></dt>
<dd><p>poly / spline normalization
spline –&gt; normalize_spectrum_spline: dict(p=1e-6, q=0.5, lu=(-2, 3), binwidth=100., niter=3)
poly   –&gt; normalize_spectrum_poly: (deg=4, lu=(-2, 3), q=0.5, binwidth=100., niter=3, pw=1.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<em>array</em>) – wavelength</p></li>
<li><p><strong>flux</strong> (<em>array</em>) – flux</p></li>
<li><p><strong>norm_type</strong> (<em>str</em>) – “spline” / “poly”</p></li>
<li><p><strong>deg</strong> (<em>int</em>) – poly deg</p></li>
<li><p><strong>lu</strong> (<em>tuple</em>) – defaults to (-1, 4), the data below 1 sigma and above 4 sigma will be excluded</p></li>
<li><p><strong>q</strong> (<em>float</em>) – percentile, default is 0.5,</p></li>
<li><p><strong>binwidth</strong> – bin width, detault to 100.</p></li>
<li><p><strong>niter</strong> – number of iterations, detaults to 3</p></li>
<li><p><strong>pw</strong> – power of residuals, defaults to 1, only used when norm_type==”poly”</p></li>
<li><p><strong>p</strong> – spline smoothness, defaults to 1e-6</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.normalization.normalize_spectrum_null">
<code class="sig-prename descclassname">laspec.normalization.</code><code class="sig-name descname">normalize_spectrum_null</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/normalization.html#normalize_spectrum_null"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.normalization.normalize_spectrum_null" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.normalization.normalize_spectrum_poly">
<code class="sig-prename descclassname">laspec.normalization.</code><code class="sig-name descname">normalize_spectrum_poly</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">flux</span></em>, <em class="sig-param"><span class="n">deg</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">pw</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">lu</span><span class="o">=</span><span class="default_value">(- 1, 4)</span></em>, <em class="sig-param"><span class="n">q</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">binwidth</span><span class="o">=</span><span class="default_value">100.0</span></em>, <em class="sig-param"><span class="n">niter</span><span class="o">=</span><span class="default_value">3</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/normalization.html#normalize_spectrum_poly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.normalization.normalize_spectrum_poly" title="Permalink to this definition">¶</a></dt>
<dd><p>normalize spectrum using polynomial</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.normalization.normalize_spectrum_spline">
<code class="sig-prename descclassname">laspec.normalization.</code><code class="sig-name descname">normalize_spectrum_spline</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">flux</span></em>, <em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">1e-06</span></em>, <em class="sig-param"><span class="n">q</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">lu</span><span class="o">=</span><span class="default_value">(- 1, 3)</span></em>, <em class="sig-param"><span class="n">binwidth</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">niter</span><span class="o">=</span><span class="default_value">3</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/normalization.html#normalize_spectrum_spline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.normalization.normalize_spectrum_spline" title="Permalink to this definition">¶</a></dt>
<dd><p>A double smooth normalization of a spectrum</p>
<p>Converted from Chao Liu’s normSpectrum.m
Updated by Bo Zhang</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<em>ndarray</em><em> (</em><em>n_pix</em><em>, </em><em>)</em>) – wavelegnth array</p></li>
<li><p><strong>flux</strong> (<em>ndarray</em><em> (</em><em>n_pix</em><em>, </em><em>)</em>) – flux array</p></li>
<li><p><strong>p</strong> (<em>float</em>) – smoothing parameter between 0 and 1:
0 -&gt; LS-straight line
1 -&gt; cubic spline interpolant</p></li>
<li><p><strong>q</strong> (<em>float in range of</em><em> [</em><em>0</em><em>, </em><em>1</em><em>]</em>) – percentile, between 0 and 1</p></li>
<li><p><strong>lu</strong> (<em>float tuple</em>) – the lower &amp; upper exclusion limits</p></li>
<li><p><strong>binwidth</strong> (<em>float</em>) – width of each bin</p></li>
<li><p><strong>niter</strong> (<em>int</em>) – number of iterations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>flux_norm</strong> (<em>ndarray</em>) – normalized flux</p></li>
<li><p><strong>flux_cont</strong> (<em>ndarray</em>) – continuum flux</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fnorm</span><span class="p">,</span> <span class="n">fcont</span><span class="o">=</span><span class="n">normalize_spectrum_spline</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">wave</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">binwidth</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">lu</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">niter</span><span class="o">=</span><span class="n">niter</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-laspec.optimize">
<span id="laspec-optimize-module"></span><h2>laspec.optimize module<a class="headerlink" href="#module-laspec.optimize" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="laspec.optimize.RandomWalkMinimizer">
<em class="property">class </em><code class="sig-prename descclassname">laspec.optimize.</code><code class="sig-name descname">RandomWalkMinimizer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fun</span></em>, <em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="n">dx</span></em>, <em class="sig-param"><span class="n">maxiter</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">args</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">optind</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">random</span><span class="o">=</span><span class="default_value">'normal'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/optimize.html#RandomWalkMinimizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.optimize.RandomWalkMinimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Random Walk Minimizer</p>
<dl class="py method">
<dt id="laspec.optimize.RandomWalkMinimizer.minimize">
<em class="property">static </em><code class="sig-name descname">minimize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fun</span></em>, <em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="n">dx</span></em>, <em class="sig-param"><span class="n">maxiter</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">args</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kwargs</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">optind</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">info</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">random</span><span class="o">=</span><span class="default_value">'normal'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/optimize.html#RandomWalkMinimizer.minimize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.optimize.RandomWalkMinimizer.minimize" title="Permalink to this definition">¶</a></dt>
<dd><p>a single</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fun</strong> – objective function</p></li>
<li><p><strong>x0</strong> (<em>array like</em>) – initial guess of x</p></li>
<li><p><strong>dx</strong> – a list of different scales. e.g. []</p></li>
<li><p><strong>maxiter</strong> – number of max iterations</p></li>
<li><p><strong>args</strong> – fun(x, <a href="#id1"><span class="problematic" id="id2">*</span></a>args, <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs)</p></li>
<li><p><strong>kwargs</strong> – fun(x, <a href="#id5"><span class="problematic" id="id6">*</span></a>args, <a href="#id7"><span class="problematic" id="id8">**</span></a>kwargs)</p></li>
<li><p><strong>optind</strong> – a subset ind of parameters, e.g., [5, 7]</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – if True, print verbose</p></li>
<li><p><strong>random</strong> (<em>[</em><em>uniform</em><em>, </em><em>normal</em><em>]</em>) – type of random number generator</p></li>
<li><p><strong>info</strong> – additional info appended in msg</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="laspec.optimize.RandomWalkMinimizer.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fun</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dx</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">maxiter</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">args</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kwargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">optind</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">random</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/optimize.html#RandomWalkMinimizer.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.optimize.RandomWalkMinimizer.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="laspec.optimize.test1">
<code class="sig-prename descclassname">laspec.optimize.</code><code class="sig-name descname">test1</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/optimize.html#test1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.optimize.test1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.optimize.test2">
<code class="sig-prename descclassname">laspec.optimize.</code><code class="sig-name descname">test2</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/optimize.html#test2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.optimize.test2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.optimize.test3">
<code class="sig-prename descclassname">laspec.optimize.</code><code class="sig-name descname">test3</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/optimize.html#test3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.optimize.test3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-laspec.qconv">
<span id="laspec-qconv-module"></span><h2>laspec.qconv module<a class="headerlink" href="#module-laspec.qconv" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="laspec.qconv.Gaussian_kernel">
<code class="sig-prename descclassname">laspec.qconv.</code><code class="sig-name descname">Gaussian_kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dRV_sampling</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">dRV_Gk</span><span class="o">=</span><span class="default_value">2.3548200450309493</span></em>, <em class="sig-param"><span class="n">n_sigma_Gk</span><span class="o">=</span><span class="default_value">5.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/qconv.html#Gaussian_kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.qconv.Gaussian_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaussian kernel</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dRV_sampling</strong> – the sampling rate of the input spectrum (km/s)</p></li>
<li><p><strong>dRV_Gk</strong> – the sampling rate of the Gaussian kernel (km/s)</p></li>
<li><p><strong>n_sigma_Gk</strong> – the length of the Gaussian kernel, in terms of sigma</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Gaussian kernel</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.qconv.Rotation_kernel">
<code class="sig-prename descclassname">laspec.qconv.</code><code class="sig-name descname">Rotation_kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dRV_sampling</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">vsini</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">epsilon</span><span class="o">=</span><span class="default_value">0.6</span></em>, <em class="sig-param"><span class="n">osr_kernel</span><span class="o">=</span><span class="default_value">3</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/qconv.html#Rotation_kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.qconv.Rotation_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotation kernel</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dRV_sampling</strong> – the sampling rate of the input spectrum (km/s)</p></li>
<li><p><strong>vsini</strong> – v*sin(i)  (km/s)</p></li>
<li><p><strong>epsilon</strong> – the limb-darkening coefficient (0, 1)</p></li>
<li><p><strong>osr_kernel</strong> – the over-sampling rate of the kernel</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rotation kernel</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.qconv.conv_spec_Gaussian">
<code class="sig-prename descclassname">laspec.qconv.</code><code class="sig-name descname">conv_spec_Gaussian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">flux</span></em>, <em class="sig-param"><span class="n">dRV_Gk</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">R_hi</span><span class="o">=</span><span class="default_value">300000.0</span></em>, <em class="sig-param"><span class="n">R_lo</span><span class="o">=</span><span class="default_value">2000.0</span></em>, <em class="sig-param"><span class="n">n_sigma_Gk</span><span class="o">=</span><span class="default_value">5.0</span></em>, <em class="sig-param"><span class="n">interp</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">osr_ext</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">wave_new</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/qconv.html#conv_spec_Gaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.qconv.conv_spec_Gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>to convolve instrumental broadening (high-R spectrum to low-R spectrum)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<em>array</em>) – wavelength</p></li>
<li><p><strong>flux</strong> (<em>array</em>) – flux array</p></li>
<li><p><strong>dRV_Gk</strong> (<em>float</em>) – the FWHM of the Gaussian kernel (km/s)
if None, determined by R_hi and R_lo</p></li>
<li><p><strong>R_hi</strong> (<em>float</em>) – higher resolution</p></li>
<li><p><strong>R_lo</strong> (<em>float</em>) – lower resolution</p></li>
<li><p><strong>n_sigma_Gk</strong> (<em>float</em>) – the gaussian kernel width in terms of sigma</p></li>
<li><p><strong>interp</strong> (<em>bool</em>) – if True, interpolate to log10 wavelength</p></li>
<li><p><strong>osr_ext</strong> – the extra oversampling rate if interp is True.</p></li>
<li><p><strong>wave_new</strong> – if not None, return convolved spectrum at wave_new
if None, return log10 spectrum</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>wave_new, flux_new</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.qconv.conv_spec_Rotation">
<code class="sig-prename descclassname">laspec.qconv.</code><code class="sig-name descname">conv_spec_Rotation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">flux</span></em>, <em class="sig-param"><span class="n">vsini</span><span class="o">=</span><span class="default_value">100.0</span></em>, <em class="sig-param"><span class="n">epsilon</span><span class="o">=</span><span class="default_value">0.6</span></em>, <em class="sig-param"><span class="n">interp</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">osr_ext</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">wave_new</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/qconv.html#conv_spec_Rotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.qconv.conv_spec_Rotation" title="Permalink to this definition">¶</a></dt>
<dd><p>to convolve instrumental broadening (high-R spectrum to low-R spectrum)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<em>array</em>) – wavelength</p></li>
<li><p><strong>flux</strong> (<em>array</em>) – flux array</p></li>
<li><p><strong>vsini</strong> (<em>float</em>) – the projected stellar rotational velocity (km/s)</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – 0 to 1, the limb-darkening coefficient, default 0.6.</p></li>
<li><p><strong>interp</strong> (<em>bool</em>) – if True, interpolate to log10 wavelength</p></li>
<li><p><strong>osr_ext</strong> – the extra oversampling rate if interp is True.</p></li>
<li><p><strong>wave_new</strong> – if not None, return convolved spectrum at wave_new
if None, return log10 spectrum</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>wave_new, flux_new OR Table([wave, flux])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.qconv.read_phoenix_sun">
<code class="sig-prename descclassname">laspec.qconv.</code><code class="sig-name descname">read_phoenix_sun</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/qconv.html#read_phoenix_sun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.qconv.read_phoenix_sun" title="Permalink to this definition">¶</a></dt>
<dd><p>read PHOENIX synthetic spectrum for the Sun</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.qconv.test_convolution">
<code class="sig-prename descclassname">laspec.qconv.</code><code class="sig-name descname">test_convolution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/qconv.html#test_convolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.qconv.test_convolution" title="Permalink to this definition">¶</a></dt>
<dd><p>testing convolving PHOENIX synthetic spectrum for the Sun</p>
</dd></dl>

</div>
<div class="section" id="module-laspec.read_spectrum">
<span id="laspec-read-spectrum-module"></span><h2>laspec.read_spectrum module<a class="headerlink" href="#module-laspec.read_spectrum" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="laspec.read_spectrum.MedSpec">
<em class="property">class </em><code class="sig-prename descclassname">laspec.read_spectrum.</code><code class="sig-name descname">MedSpec</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/read_spectrum.html#MedSpec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.read_spectrum.MedSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">collections.OrderedDict</span></code></p>
<p>for Median Resolution Spectrum</p>
<dl class="py attribute">
<dt id="laspec.read_spectrum.MedSpec.meta">
<code class="sig-name descname">meta</code><em class="property"> = None</em><a class="headerlink" href="#laspec.read_spectrum.MedSpec.meta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.read_spectrum.MedSpec.read">
<em class="property">static </em><code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fp</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/read_spectrum.html#MedSpec.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.read_spectrum.MedSpec.read" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="laspec.read_spectrum.read_lamostms">
<code class="sig-prename descclassname">laspec.read_spectrum.</code><code class="sig-name descname">read_lamostms</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fp</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/read_spectrum.html#read_lamostms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.read_spectrum.read_lamostms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.read_spectrum.read_spectrum">
<code class="sig-prename descclassname">laspec.read_spectrum.</code><code class="sig-name descname">read_spectrum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filepath</span></em>, <em class="sig-param"><span class="n">filesource</span><span class="o">=</span><span class="default_value">'auto'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/read_spectrum.html#read_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.read_spectrum.read_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>read SDSS/LAMOST spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>string</em>) – input file path</p></li>
<li><p><strong>filesource</strong> (<em>string</em>) – {‘sdss_dr12’ / ‘lamost_dr2’ / ‘lamost_dr3’}</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>specdata</strong> – spectra as a table</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.table.Table</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.read_spectrum.read_spectrum_elodie_r42000">
<code class="sig-prename descclassname">laspec.read_spectrum.</code><code class="sig-name descname">read_spectrum_elodie_r42000</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fp</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/read_spectrum.html#read_spectrum_elodie_r42000"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.read_spectrum.read_spectrum_elodie_r42000" title="Permalink to this definition">¶</a></dt>
<dd><p>read spectrum from ELODIE library (R42000)</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.read_spectrum.read_spectrum_phoenix_r10000">
<code class="sig-prename descclassname">laspec.read_spectrum.</code><code class="sig-name descname">read_spectrum_phoenix_r10000</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fp</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/read_spectrum.html#read_spectrum_phoenix_r10000"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.read_spectrum.read_spectrum_phoenix_r10000" title="Permalink to this definition">¶</a></dt>
<dd><p>read spectrum from PHOENIX R10000</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.read_spectrum.reconstruct_wcs_coord_from_fits_header">
<code class="sig-prename descclassname">laspec.read_spectrum.</code><code class="sig-name descname">reconstruct_wcs_coord_from_fits_header</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hdr</span></em>, <em class="sig-param"><span class="n">dim</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/read_spectrum.html#reconstruct_wcs_coord_from_fits_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.read_spectrum.reconstruct_wcs_coord_from_fits_header" title="Permalink to this definition">¶</a></dt>
<dd><p>reconstruct wcs coordinates (e.g., wavelength array)</p>
</dd></dl>

</div>
<div class="section" id="module-laspec.rvc">
<span id="laspec-rvc-module"></span><h2>laspec.rvc module<a class="headerlink" href="#module-laspec.rvc" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="laspec.rvc.RVC">
<em class="property">class </em><code class="sig-prename descclassname">laspec.rvc.</code><code class="sig-name descname">RVC</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">ra</span></em>, <em class="sig-param"><span class="n">dec</span></em>, <em class="sig-param"><span class="n">rv_obs</span></em>, <em class="sig-param"><span class="n">rv_obs_err</span></em>, <em class="sig-param"><span class="n">rv_std</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rv_std_err</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rv_val</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rv_val_err</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/rvc.html#RVC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.rvc.RVC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>radial velocity calibrator</p>
<dl class="py attribute">
<dt id="laspec.rvc.RVC.star_weight">
<code class="sig-name descname">star_weight</code><em class="property"> = array([], dtype=float64)</em><a class="headerlink" href="#laspec.rvc.RVC.star_weight" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-laspec.slam_model">
<span id="laspec-slam-model-module"></span><h2>laspec.slam_model module<a class="headerlink" href="#module-laspec.slam_model" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="laspec.slam_model.create_nn_regressor">
<code class="sig-prename descclassname">laspec.slam_model.</code><code class="sig-name descname">create_nn_regressor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ninput</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">nhidden</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">noutput</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">dropout_rate</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">activation_hidden</span><span class="o">=</span><span class="default_value">'sigmoid'</span></em>, <em class="sig-param"><span class="n">activation_output</span><span class="o">=</span><span class="default_value">'sigmoid'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/slam_model.html#create_nn_regressor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.slam_model.create_nn_regressor" title="Permalink to this definition">¶</a></dt>
<dd><p>An easy way of creating DNN with 2 dense layers (1 hidden layer)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ninput</strong> – input shape</p></li>
<li><p><strong>nhidden</strong> (<em>tuple</em>) – number of neurons in dense layers</p></li>
<li><p><strong>dropout_rate</strong> – dropout rate</p></li>
<li><p><strong>noutput</strong> – output shape</p></li>
<li><p><strong>activation_hidden</strong> – the activation function used in hidden layers</p></li>
<li><p><strong>activation_output</strong> – the activation function used in output layers</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.slam_model.test_create_nn_regressor">
<code class="sig-prename descclassname">laspec.slam_model.</code><code class="sig-name descname">test_create_nn_regressor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/slam_model.html#test_create_nn_regressor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.slam_model.test_create_nn_regressor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-laspec.snstat">
<span id="laspec-snstat-module"></span><h2>laspec.snstat module<a class="headerlink" href="#module-laspec.snstat" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="laspec.snstat.eval_xi_1">
<code class="sig-prename descclassname">laspec.snstat.</code><code class="sig-name descname">eval_xi_1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/snstat.html#eval_xi_1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.snstat.eval_xi_1" title="Permalink to this definition">¶</a></dt>
<dd><p>convert to MAD</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.snstat.eval_xi_2">
<code class="sig-prename descclassname">laspec.snstat.</code><code class="sig-name descname">eval_xi_2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/snstat.html#eval_xi_2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.snstat.eval_xi_2" title="Permalink to this definition">¶</a></dt>
<dd><p>convert to MAD</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.snstat.eval_zeta_q">
<code class="sig-prename descclassname">laspec.snstat.</code><code class="sig-name descname">eval_zeta_q</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/snstat.html#eval_zeta_q"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.snstat.eval_zeta_q" title="Permalink to this definition">¶</a></dt>
<dd><p>convert to std</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.snstat.eval_zeta_std">
<code class="sig-prename descclassname">laspec.snstat.</code><code class="sig-name descname">eval_zeta_std</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/snstat.html#eval_zeta_std"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.snstat.eval_zeta_std" title="Permalink to this definition">¶</a></dt>
<dd><p>convert to std</p>
</dd></dl>

</div>
<div class="section" id="module-laspec.spec">
<span id="laspec-spec-module"></span><h2>laspec.spec module<a class="headerlink" href="#module-laspec.spec" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="laspec.spec.Spec">
<em class="property">class </em><code class="sig-prename descclassname">laspec.spec.</code><code class="sig-name descname">Spec</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/spec.html#Spec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.spec.Spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.table.table.Table</span></code></p>
<dl class="py method">
<dt id="laspec.spec.Spec.extract_chunk_wave_interval">
<code class="sig-name descname">extract_chunk_wave_interval</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave_intervals</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/spec.html#Spec.extract_chunk_wave_interval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.spec.Spec.extract_chunk_wave_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>return spec chunk in a given wavelength interval</p>
</dd></dl>

<dl class="py method">
<dt id="laspec.spec.Spec.norm_spec_median">
<code class="sig-name descname">norm_spec_median</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/spec.html#Spec.norm_spec_median"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.spec.Spec.norm_spec_median" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="laspec.spec.Spec.norm_spec_pixel">
<code class="sig-name descname">norm_spec_pixel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norm_wave</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/spec.html#Spec.norm_spec_pixel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.spec.Spec.norm_spec_pixel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="laspec.spec.break_spectra_into_chunks">
<code class="sig-prename descclassname">laspec.spec.</code><code class="sig-name descname">break_spectra_into_chunks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec_list</span></em>, <em class="sig-param"><span class="n">ranges</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">amp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/spec.html#break_spectra_into_chunks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.spec.break_spectra_into_chunks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.spec.break_spectrum_into_chunks">
<code class="sig-prename descclassname">laspec.spec.</code><code class="sig-name descname">break_spectrum_into_chunks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span></em>, <em class="sig-param"><span class="n">ranges</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">amp</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/spec.html#break_spectrum_into_chunks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.spec.break_spectrum_into_chunks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.spec.norm_spec_chunk_median">
<code class="sig-prename descclassname">laspec.spec.</code><code class="sig-name descname">norm_spec_chunk_median</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec_chunks</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/spec.html#norm_spec_chunk_median"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.spec.norm_spec_chunk_median" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.spec.norm_spec_median">
<code class="sig-prename descclassname">laspec.spec.</code><code class="sig-name descname">norm_spec_median</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/spec.html#norm_spec_median"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.spec.norm_spec_median" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.spec.norm_spec_pixel">
<code class="sig-prename descclassname">laspec.spec.</code><code class="sig-name descname">norm_spec_pixel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span></em>, <em class="sig-param"><span class="n">norm_wave</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/spec.html#norm_spec_pixel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.spec.norm_spec_pixel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="laspec.spec.spec_quick_init">
<code class="sig-prename descclassname">laspec.spec.</code><code class="sig-name descname">spec_quick_init</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">flux</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/spec.html#spec_quick_init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.spec.spec_quick_init" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> (<em>numpy.ndarray</em>) – wavelength array</p></li>
<li><p><strong>flux</strong> (<em>numpy.ndarray</em>) – flux array</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spec_</strong> – Spec, at least contains ‘wave’ and ‘flux’ columns.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bopy.spec.Spec</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.spec.wave2ranges">
<code class="sig-prename descclassname">laspec.spec.</code><code class="sig-name descname">wave2ranges</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">wave_intervals</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/spec.html#wave2ranges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.spec.wave2ranges" title="Permalink to this definition">¶</a></dt>
<dd><p>convert wavelength intervals to (pixel) ranges</p>
</dd></dl>

</div>
<div class="section" id="module-laspec.stilts">
<span id="laspec-stilts-module"></span><h2>laspec.stilts module<a class="headerlink" href="#module-laspec.stilts" title="Permalink to this headline">¶</a></h2>
<p>python wrapper of stilts</p>
</div>
<div class="section" id="module-laspec.wavelength">
<span id="laspec-wavelength-module"></span><h2>laspec.wavelength module<a class="headerlink" href="#module-laspec.wavelength" title="Permalink to this headline">¶</a></h2>
<p>This module implements the conversion of wavelengths between vacuum and air
Reference: Donald Morton (2000, ApJ. Suppl., 130, 403)
VALD3 link: <a class="reference external" href="http://www.astro.uu.se/valdwiki/Air-to-vacuum%20conversion">http://www.astro.uu.se/valdwiki/Air-to-vacuum%20conversion</a></p>
<dl class="py function">
<dt id="laspec.wavelength.air2vac">
<code class="sig-prename descclassname">laspec.wavelength.</code><code class="sig-name descname">air2vac</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave_air</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/wavelength.html#air2vac"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.wavelength.air2vac" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wave_air</strong> – wavelength (A) in air</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>wavelength (A) in vacuum</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>wave_vac</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.wavelength.mdwave">
<code class="sig-prename descclassname">laspec.wavelength.</code><code class="sig-name descname">mdwave</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/wavelength.html#mdwave"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.wavelength.mdwave" title="Permalink to this definition">¶</a></dt>
<dd><p>median delta wavelength</p>
</dd></dl>

<dl class="py function">
<dt id="laspec.wavelength.vac2air">
<code class="sig-prename descclassname">laspec.wavelength.</code><code class="sig-name descname">vac2air</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave_vac</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/wavelength.html#vac2air"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.wavelength.vac2air" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wave_vac</strong> – wavelength (A) in vacuum</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>wavelength (A) in air</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>wave_air</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="laspec.wavelength.wave_log10">
<code class="sig-prename descclassname">laspec.wavelength.</code><code class="sig-name descname">wave_log10</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wave</span></em>, <em class="sig-param"><span class="n">osr_ext</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">dwave</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/laspec/wavelength.html#wave_log10"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#laspec.wavelength.wave_log10" title="Permalink to this definition">¶</a></dt>
<dd><p>generate log10 wavelength array given wave array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave</strong> – old wavelength array</p></li>
<li><p><strong>osr_ext</strong> – extra over-sampling rate</p></li>
<li><p><strong>dwave</strong> – delta wavelength. if not specified, use median(dwave).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wave_new</span> <span class="o">=</span> <span class="n">wave_log10</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span> <span class="n">osr_ext</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-laspec">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-laspec" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="tutorial.html" class="btn btn-neutral float-left" title="Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Bo Zhang.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>